<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>9&nbsp; Assembling functions – MOSAIC Calculus</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Modeling/10-functions-with-multiple-inputs.html" rel="next">
<link href="../Modeling/08-parameters.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
</head><body class="nav-sidebar floating nav-fixed slimcontent"><span class="math inline" style="display: none;">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}
\newcommand{\pnorm}{\text{pnorm}}
\newcommand{\dnorm}{\text{dnorm}}
\let\origvec\vec
\let\origmathit\mathit
\let\orighat\hat
\let\origbar\bar
\newcommand{\vec}[1]{\overset{{\rule[-1pt]{0mm}{1mm}}\rightharpoonup}{\mathbf{#1}}}
\newcommand{\bar}[1]{\overset{{\rule[-1pt]{12pt}{.5mm}}}{\mathbf{#1}}}
\newcommand{\mathit}[1]{\underset{\leftharpoondown}{\overset{{\rightharpoonup}}{\large\mathbf #1}}}
\newcommand{\hat}[1]{\widehat{\ \mathbf#1\ }}
\newcommand{\len}[1]{{\|{\mathbf #1}\|}}
\newcommand{\tvec}[1]{\overset{\uparrow}{\mathbf #1}}
\newcommand{\tmat}[1]{\overset{\leftrightarrows}{\mathbf #1}}
\newcommand{\perpendicularto}[2]{#1\!\perp\!#2}
\newcommand{\modeledby}[2]{#1\!\sim\!#2}
\newcommand{\CC}[1]{\color{#648fff}{#1}}
\newcommand{\CE}[1]{\color{#785ef0}{#1}}
\newcommand{\CA}[1]{\color{#dc267f}{#1}}
\newcommand{\CB}[1]{\color{#fe6100}{#1}}
\newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
</span>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../mosaic-calc-style.css">




<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../www/Cover-1.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MOSAIC Calculus</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/dtkaplan/MC2/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../modeling-part.html">BLOCK I. Modeling</a></li><li class="breadcrumb-item"><a href="../Modeling/09-assembling-functions.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Assembling functions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../preliminaries-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PRELIMINARIES</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/01-quant-fun-space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Quantity, function, space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/02-notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/03-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Computing with R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/04-graphs-and-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visualizing functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/05-pattern-book-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pattern-book functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/06-describing-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Describing functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/07-data-functions-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data, functions, graphics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../modeling-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK I. Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/08-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parameters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/09-assembling-functions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Assembling functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/10-functions-with-multiple-inputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Functions with multiple inputs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/11-fitting-features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fitting features</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/12-low-order-polynomials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Low-order polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/13-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Operations on functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/14-magnitudes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Magnitude</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/15-dimensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Dimensions and units</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/16-modeling-scientific-method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Modeling and the scientific method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/Modeling-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projects</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#linear-combination" id="toc-linear-combination" class="nav-link active" data-scroll-target="#linear-combination"><span class="header-section-number">9.1</span> Linear combination</a></li>
  <li><a href="#sec-function-composition" id="toc-sec-function-composition" class="nav-link" data-scroll-target="#sec-function-composition"><span class="header-section-number">9.2</span> Function composition</a></li>
  <li><a href="#sec-function-multiplication" id="toc-sec-function-multiplication" class="nav-link" data-scroll-target="#sec-function-multiplication"><span class="header-section-number">9.3</span> Function multiplication</a></li>
  <li><a href="#sec-piecewise-intro" id="toc-sec-piecewise-intro" class="nav-link" data-scroll-target="#sec-piecewise-intro"><span class="header-section-number">9.4</span> Splitting the domain</a>
  <ul class="collapse">
  <li><a href="#computing-notation" id="toc-computing-notation" class="nav-link" data-scroll-target="#computing-notation"><span class="header-section-number">9.4.1</span> Computing notation</a></li>
  </ul></li>
  <li><a href="#computing-outside-the-domain" id="toc-computing-outside-the-domain" class="nav-link" data-scroll-target="#computing-outside-the-domain"><span class="header-section-number">9.5</span> Computing outside the domain</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dtkaplan/MC2/edit/main/Modeling/09-assembling-functions.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../modeling-part.html">BLOCK I. Modeling</a></li><li class="breadcrumb-item"><a href="../Modeling/09-assembling-functions.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Assembling functions</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-assembling" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Assembling functions</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>When a modeler needs a new function for some purpose, there are three tactics; the best one depends on the circumstances and the availability of data.</p>
<ol type="1">
<li>Assemble the function from combinations of input-scaled pattern-book functions.</li>
</ol>
<p>This tactic is well represented in Calculus textbooks. I think this is not so much a statement about the power of the tactic, but the general tendency to avoid working with data. For the applications of applied math, data is a valuable resource. When it’s available, as is often the case, there are alternatives to (1) that are available.</p>
<ol start="2" type="1">
<li><p>Use the data to guide the input and output scaling of pattern-book functions and their generalizations such as the power-law functions introduced in <a href="../Preliminaries/05-pattern-book-functions.html#sec-power-law-family" class="quarto-xref"><span>Section 5.2</span></a>. This is often called “<strong>fitting the function</strong>”. We will study this tactic and its techniques in <a href="11-fitting-features.html" class="quarto-xref"><span>Chapter 11</span></a>.</p></li>
<li><p>Split the domain of the desired function into small pieces. Then, for each piece, use very simple functions to capture the <strong>local behavior</strong> of a function locally. As the simple functions, the lower-order polynomaials <code>x ~ a x</code> or <code>x ~a x + b</code> or <code>x ~ a x^ + b x^2</code> are widely used. The parameters are set entirely by data. This strategy was originally called “statistical learning,” then renamed “machine learning.” These days, “artificial intelligence” is used to refer to a particular strategy of <em>iteration</em> that slowly and gently incorporates data to tease the model parameters into a function that makes good predictions.</p></li>
</ol>
<p>This chapter focusses on the mathematical framework for (1). In <a href="11-fitting-features.html" class="quarto-xref"><span>Chapter 11</span></a> we will introduce the incorporation of data used in tactic (2). As for (3), we will need several core concepts of calculus as a basis for understanding, so we mainly defer the tactic to <span class="quarto-unresolved-ref">?sec-splines</span>.</p>
<section id="linear-combination" class="level2 page-columns page-full" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="linear-combination"><span class="header-section-number">9.1</span> Linear combination</h2>
<p><a href="08-parameters.html#sec-output-scaling" class="quarto-xref"><span>Section 8.4</span></a> introduced the notation of input and output scaling. For instance, <a href="11-fitting-features.html#fig-tides-ri2" class="quarto-xref">Figure&nbsp;<span>11.6</span></a> illustrates how the pattern-book <span class="math inline">\(\sin()\)</span> function can be customized to model a particular situation. Recall that the input scaling involves inserting a straight-line function <em>inside</em> the parentheses, as in</p>
<p><span id="eq-input-scaled-sin"><span class="math display">\[f_1(t) \equiv \sin\left( a t + b\right) \tag{9.1}\]</span></span></p>
<p>You may recognize <span class="math inline">\(at + b\)</span> as a straight-line function. Possibly, your recognition would be easier if we wrote <span class="math inline">\(at + b\)</span> using different names for the input and the first parameter: <span class="math inline">\(m x + b\)</span>. You have been trained to pronounce <span class="math inline">\(m\)</span> as the “slope” of the line and <span class="math inline">\(b\)</span> as the “y-intercept.”</p>
<p>Using both input and output scaling gives a more general kind of function:</p>
<p><span id="eq-input-output-scaled-sin"><span class="math display">\[f_2(t) \equiv A \sin(a t + b) + B \tag{9.2}\]</span></span></p>
<p><a href="#eq-input-output-scaled-sin" class="quarto-xref">Math expression&nbsp;<span>9.2</span></a> is an example of a <strong>linear combination</strong> of two functions. The two functions are <span class="math inline">\(g_1(t) \equiv 1\)</span> and <span class="math inline">\(g_2(t) \equiv sin(a t + b)\)</span>.</p>
<p>It might be easier to see <a href="#eq-input-output-scaled-sin" class="quarto-xref">Math expression&nbsp;<span>9.2</span></a> as a linear combination if the function were written explicitly using the two functions being combined, that is, as</p>
<p><span class="math display">\[f_2 \equiv A g_2(t) + B g_1(t)\]</span></p>
<p>The combination is made by scaling each of the functions involved then adding the scaled functions together. The two scaling factors, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, could be called “parameters of <span class="math inline">\(f_2()\)</span>,” which indeed they are. It would be good to get used to another word that’s used specifically for the parameters in a linear combination: “<strong>coefficients</strong>.” The advantage of “coefficients” as a name lies in it marking the parameters as those involved in a linear combination, rather than any of the other ways parameters can be used.</p>
<p>Note that “coefficients” always refers to parameters that are not inside the parentheses of a function. In contrast, often parameters are inside the parentheses as in <a href="#eq-input-scaled-sin" class="quarto-xref">Math expression&nbsp;<span>9.1</span></a>. The parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> in <span class="math inline">\(\sin(a t + b)\)</span> are <em>inside</em> the parentheses. Consequently, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> shouldn’t be called “coefficients.” Sometimes, to emphasize this, parameters in parentheses are called “nonlinear parameters” to distinguish them from coefficients like <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<p>To illustrate how linear combination is used to create new functions, consider polynomials, for instance, <span class="math display">\[f(x) \equiv 3 x^2 + 5 x - 2\ .\]</span> There are three pattern-book functions in this polynomial. In polynomials the functions being combined are all power-law functions: <span class="math inline">\(g_0(x) \equiv 1\)</span>, <span class="math inline">\(g_1(x) \equiv x\)</span>, and <span class="math inline">\(g_2(x) \equiv x^2\)</span>. With these functions defined, we can write the polynomial <span class="math inline">\(f(x)\)</span> as <span class="math display">\[f(x) \equiv 3 g_2(x) + 5 g_1(x) - 2 g_0(x)\]</span> Each of the functions is being scaled by a quantity: 3, 5, and -2 respectively. Then the scaled functions are added up. That is a linear combination; scale and add.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">In high school, polynomials are often presented as puzzles—factor them to find the roots! In calculus, however, polynomials are used as functions for modeling. They are a kind of modeling “clay,” which can be shaped as needed.</span></div></div>
<p>Linear combination is an extremely important tactic that quantitative workers use throughout their careers. For instance, many physical systems are described by linear combinations. For instance, the motion of a vibrating molecule, a helicopter in flight, or a building shaken by an earthquake are described in terms of simple “modes” which are linearly combined to make up the entire motion. More down to Earth, the timbre of a musical instrument is set by the scalars in a linear combination of pure tones. And throughout work with data in science, commerce, government and other fields a primary data analysis method—called “regression”—is about finding the best linear combination of a set of explanatory variables to create a model function of the response variable.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Identical vs proportional vs straight-line
</div>
</div>
<div class="callout-body-container callout-body">
<p>One of the pattern book functions is very simple; the output is identical to the input:</p>
<p><span class="math display">\[\text{identity}(x) \equiv x\]</span> Multiplying the identity() function by a parameter gives a function that can well be called “proportional().”</p>
<p><span class="math display">\[\text{proportional}(x) \equiv a\ \text{identity}(x) = a\ x\]</span> The parameter <span class="math inline">\(a\)</span> is often called the “<strong>constant of proportionality</strong>.”</p>
<p>It’s common to call this closely related function the “linear” function, but a better name is the “straight-line” function. “Straight-line” is the name we shall use in this book.</p>
<p><span class="math display">\[\text{straight_line}(x) \equiv a\ x + b\]</span></p>
</div>
</div>
</section>
<section id="sec-function-composition" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sec-function-composition"><span class="header-section-number">9.2</span> Function composition</h2>
<p><strong>Function composition</strong> refers to combining functions by taking the input of one function and feeding it as input to another. “<span class="math inline">\(g()\)</span> composed with <span class="math inline">\(h()\)</span>” means <span class="math inline">\(g(h(x))\)</span>.</p>
<p>To illustrate, consider again the function defined in <a href="#eq-input-output-scaled-sin" class="quarto-xref">Math expression&nbsp;<span>9.2</span></a>: <span class="math display">\[f(t) \equiv A \sin\left( a t + b\right) + B\]</span></p>
<p>You’ve already seen how <span class="quarto-unresolved-ref">?eq-input-outout-scaled-sin</span> is a linear combination of two functions <span class="math inline">\(f_1(t) \equiv 1\)</span> and <span class="math inline">\(f_2(t) \equiv sin(a t + b)\)</span>. But <span class="math inline">\(f_2()\)</span> is not a linear combination. Instead, it is a function composition. The two functions being composed are <span class="math inline">\(sin(x)\)</span> and <span class="math inline">\(a t + b\)</span>, producing <span class="math inline">\(sin(a t + b)\)</span>. Here, <span class="math inline">\(\sin()\)</span> is the <strong>outer</strong> function in the composition and <span class="math inline">\(at + b\)</span> is the <strong>inner</strong> function.</p>
</section>
<section id="sec-function-multiplication" class="level2 page-columns page-full" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="sec-function-multiplication"><span class="header-section-number">9.3</span> Function multiplication</h2>
<p>Multiplication is the third in our repertoire of methods for making new functions. To review, here are the first two methods involving combining a function <span class="math inline">\(f()\)</span> with a function $g():</p>
<ol type="1">
<li>Linear combinations. Example: <span class="math inline">\(n_1(t) \equiv 5 f(t) + 1.2 g(t)\)</span>.</li>
<li>Function composition. There are two possibilities which produce two distinct functions:
<ol type="i">
<li><span class="math inline">\(c_1(t) \equiv f(g(t))\)</span>, that is, <span class="math inline">\(g()\)</span> is the <em>inner function</em>.</li>
<li><span class="math inline">\(c_2(t) \equiv g(f(t))\)</span>, that is, <span class="math inline">\(g()\)</span> is the <em>outer function</em>.</li>
</ol></li>
</ol>
<p>Now a new method:</p>
<ol start="3" type="1">
<li>Multiplication of the output of two functions. Example: <span class="math inline">\(m(t)\equiv f(t) g(t)\)</span>. This is perfectly ordinary multiplication. Multiplication is <em>commutative</em>, as illustrated by the equality of <span class="math inline">\(5 \times 2\)</span> and <span class="math inline">\(2 \times 5\)</span>. Owing to the commutativity of multiplication, it doesn’t matter whether <span class="math inline">\(f()\)</span> is first or <span class="math inline">\(g()\)</span> is first.</li>
</ol>

<div class="no-row-height column-margin column-container"><div class="">
<p>In function composition, the order of the functions matters: <span class="math inline">\(f(g(x))\)</span> and <span class="math inline">\(g(f(x))\)</span> are in general completely different functions.</p>
<p>In function multiplication, the order does not matter because multiplication is <strong><em>commutative</em></strong>, that is, if <span class="math inline">\(f()\)</span> and <span class="math inline">\(g()\)</span> are the functions to be multiplied <span class="math inline">\(f(x) \times g(x) = g(x)\times f(x)\)</span>.</p>
</div></div><p><span class="math display">\[\underbrace{f(x) \times g(x)}_\text{multiplication}\ \ \ \ \underbrace{{\Large f(}g(x){\Large)} \ \ \text{or}\ \ \ {\Large g(}f(x){\Large)}}_\text{composition}\]</span></p>
<p>In function composition, only one of the functions—the <strong><em>interior function</em></strong> is applied to the overall input, <span class="math inline">\(x\)</span> in the above example. The <strong><em>exterior function</em></strong> is fed its input from the output of the interior function.</p>
<p>In multiplication, each of the functions is applied to the input individually. Then their outputs are multiplied to produce the overall output.</p>
<div class="example">
<p><strong><em>Transient vibration</em></strong></p>
<p>A guitar string is plucked to produce a note. The sound is, of course, vibrations of the air created by vibrations of the string.</p>
<p>After plucking, the note fades away. An important model of this is a sinusoid (of the correct period to correspond to the frequency of the note) times an exponential.</p>
<p>Function multiplication is used so often in modeling that you will see it in many modeling situations. Here’s one example that is important in physics and communication: the <strong><em>wave packet</em></strong>. Overall, the wave packet is a localized oscillation as in <a href="#fig-wave-packet" class="quarto-xref">Figure&nbsp;<span>9.2</span></a>. The packet can be modeled with the product of two pattern-book functions: a gaussian times a sinusoid.</p>
</div>
<div class="cell page-columns page-full" data-layout-align="center">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-making-wave-packet" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-making-wave-packet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09-assembling-functions_files/figure-html/fig-making-wave-packet-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:140.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-making-wave-packet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.1: The two components of the wave packet in <a href="#fig-wave-packet" class="quarto-xref">Figure&nbsp;<span>9.2</span></a>: an “envelope” and an oscillation. Multiplying these components together produces the wave packet.
</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-wave-packet" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="h">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wave-packet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09-assembling-functions_files/figure-html/fig-wave-packet-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" data-fig-pos="h">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wave-packet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.2: A <em>wave packet</em> constructed by multiplying a sinusoid and a gaussian function.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled page-columns page-full" data-latex="">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math in the World: Modeling rise and fall
</div>
</div>
<div class="callout-body-container callout-body page-columns page-full">
<p>The initial rise in popularity of the social media platform <a href="https://en.wikipedia.org/wiki/Yik_Yak">Yik Yak</a> was exponential. Then popularity leveled off, promising a steady, if static, business into the future. But, the internet being what it is, popularity collapsed to near zero and the company closed.</p>
<p>One way to model this pattern is by multiplying a sigmoid by an exponential. (See <a href="#fig-yikyak" class="quarto-xref">Figure&nbsp;<span>9.3</span></a>.)</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-yikyak" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-pos="h" data-cap-location="margin" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-yikyak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09-assembling-functions_files/figure-html/fig-yikyak-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" data-fig-pos="h">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-yikyak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.3: Subscriptions to the web messaging service Yik Yak grew exponentially in 2013 and 2014, then collapsed. The company closed in 2017.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Functions constructed as a <strong><em>product</em></strong> of simple functions can look like this in tradition notation: <span class="math display">\[h(t) \equiv \sin(t) e^{-t}\]</span> and like this in computer notation:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">sin</span>(t)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>t) <span class="sc">~</span> t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-piecewise-intro" class="level2 page-columns page-full" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="sec-piecewise-intro"><span class="header-section-number">9.4</span> Splitting the domain</h2>
<p>Consider the familiar absolute-value function:</p>
<div class="cell page-columns page-full" data-layout-align="center">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-abx1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-abx1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09-assembling-functions_files/figure-html/fig-abx1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abx1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.4: The absolute-value function
</figcaption>
</figure>
</div>
</div></div></div>
<p><span class="math display">\[abs(x) \equiv \left|x\right|\]</span> Written this way, the definition of <span class="math inline">\(abs()\)</span> is a tautology: unless you already know what <span class="math inline">\(\left|x\right|\)</span> means, you will have no clue what’s going on.</p>
<p>Can we assemble <span class="math inline">\(abs(x)\)</span> out of pattern-book functions? What’s distinctive about <span class="math inline">\(abs(x)\)</span> is the break at <span class="math inline">\(x=0\)</span>. There is no similarly sharp transition in any of the pattern-book functions.</p>
<p>One way to construct the sharp transition is to view <span class="math inline">\(abs(x)\)</span> as <em>two</em> functions, one whose domain is the negative half of the number line and the other having a domain that is the non-negative half. That is, we will break the domain of <span class="math inline">\(abs()\)</span> into two <strong>pieces</strong>. For the right piece of the domain, <span class="math inline">\(abs(x)\)</span> is simply proportional<span class="math inline">\((x)\)</span>. For the left piece of the domain, <span class="math inline">\(abs(x)\)</span> is <span class="math inline">\(-\)</span>proportional<span class="math inline">\((x)\)</span>.</p>
<p>A function defined separately on different pieces of its domain is called a <strong><em>piecewise function</em></strong>. In the conventional mathematical notation, there is a large <span class="math inline">\(\LARGE\left\{\right.\)</span> followed by two or more lines. Each line gives a formula for that part of the function and indicates to which interval the formula applies.</p>
<p><span class="math display">\[abs(x) \equiv \left\{
\begin{array}{rl}  x &amp; \text{for}\ 0 \leq x \\
- x &amp; \text{otherwise}\\\end{array}
\right.\]</span></p>
<div class="cell page-columns page-full" data-layout-align="center">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-heaviside1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-heaviside1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09-assembling-functions_files/figure-html/fig-heaviside1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-heaviside1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.5: The Heaviside function
</figcaption>
</figure>
</div>
</div></div></div>
<p>Another piecewise function widely used in technical work, but not as familiar as <span class="math inline">\(abs()\)</span> is the <strong><em>Heaviside function</em></strong>, which has important uses in physics and engineering.</p>
<p><span class="math display">\[\text{Heaviside}(x) \equiv \left\{
\begin{array}{cl} 1 &amp; \text{for}\ 0 \leq x \\0 &amp; \text{otherwise}\end{array}
\right.\]</span></p>
<p>The Heaviside function is defined on the same two pieces of the number line as <span class="math inline">\(abs()\)</span>. To the right of zero, Heaviside is identical to constant(). To the left, it is identical to <span class="math inline">\(0\)</span> times constant<span class="math inline">\(()\)</span>.</p>
<p>The vertical gap between the two pieces of the Heaviside function is called a <strong><em>discontinuity</em></strong>. Intuitively, you cannot draw a discontinuous function <strong><em>without lifting the pencil from the paper</em></strong>. The Heaviside’s discontinuity occurs at input <span class="math inline">\(x=0\)</span>.</p>
<section id="computing-notation" class="level3 page-columns page-full" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="computing-notation"><span class="header-section-number">9.4.1</span> Computing notation</h3>
<p>The usual mathematical notation for piecewise functions, spread out over multiple lines that are connected with a tall brace, is an obvious non-candidate for computer notation. In R, the stitching together of the two pieces can be done with the function <code>ifelse()</code>. The name is remarkably descriptive. The <code>ifelse()</code> function takes three arguments. The first is a question to be asked, the second is the value to return if the answer is “yes,” and the third is the value to return for a “no” answer.</p>
<p>To define <span class="math inline">\(abs()\)</span> or Heaviside<span class="math inline">\(()\)</span> the relevant question is, “Is the input on the right or left side of zero on the number line?” In widely-used computing languages such as R, the format for asking a question does not involve a question mark. For example, to ask the question, “Is 3 less than 2?” use the expression:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">&lt;</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In mathematics notation, <span class="math inline">\(3 &lt; 2\)</span> is a <em>declarative</em> statement and is an impossibility. More familiar would be <span class="math inline">\(x &lt; 2\)</span>, which is again a declarative statement putting a restriction on the possible values of the quantity <span class="math inline">\(x\)</span>.</p>
<p>In computing notation, <code>3 &lt; 2</code> or <code>x &lt; 2</code> is not a declaration, it is an <em>imperative </em> statement that directs the computer to do the calculation to find out if the statement is true or false, or, as written in R, <code>TRUE</code> or <code>FALSE</code>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Remember that the tilde-expressions given as input to <code>makeFun()</code> are <em>declarative</em>, not imperative. <code>makeFun()</code> stores the tilde expression exactly as is, with symbols such as <code>x</code> being <em>names</em> rather than quantities. <code>makeFun()</code> packages up the stored tilde expression in the form of an R function. The assignment command <code>Heaviside &lt;- ...</code> gives the name <code>Heaviside</code> to the function created by <code>makeFun()</code>.</p>
<p>Only when you apply the function created by <code>makeFun()</code> to an input quantity will the tilde-expression be turned into an <em>imperative</em> statement that asks the question <code>0 &lt;= x</code> and then chooses the second or third argument to <code>ifelse()</code> as the result.</p>
</div></div><p>Here’s a definition of <code>Heaviside()</code> written with <code>ifelse()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Heaviside <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">ifelse</span>(<span class="dv">0</span> <span class="sc">&lt;=</span> x, <span class="dv">1</span>, <span class="dv">0</span>) <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#tbl-R-questions" class="quarto-xref">Table&nbsp;<span>9.1</span></a> shows computer notation for some common sorts of questions.</p>
<div class="column-page-inset-right">
<div id="tbl-R-questions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-R-questions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.1: Each of these imperative statements in R asks a question about numbers.
</figcaption>
<div aria-describedby="tbl-R-questions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th>R notation</th>
<th>English</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x &gt; 2</code></td>
<td>“Is <span class="math inline">\(x\)</span> greater than 2?”</td>
</tr>
<tr class="even">
<td><code>y &gt;= 3</code></td>
<td>“Is <span class="math inline">\(y\)</span> greater than or equal to 3?”</td>
</tr>
<tr class="odd">
<td><code>x == 4</code></td>
<td>“Is <span class="math inline">\(x\)</span> exactly 4?”</td>
</tr>
<tr class="even">
<td><code>2 &lt; x &amp; x &lt; 5</code></td>
<td>“Is <span class="math inline">\(x\)</span> between 2 and 5?” Literally, “Is <span class="math inline">\(x\)</span> both greater than 2 and less than 5?”</td>
</tr>
<tr class="odd">
<td><code>x &lt; 2 | x &gt; 6</code></td>
<td>“Is <span class="math inline">\(x\)</span> either less than 2 or greater than 6?”</td>
</tr>
<tr class="even">
<td><code>abs(x-5) &lt; 2</code></td>
<td>“Is <span class="math inline">\(x\)</span> within two units of 5?”</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled page-columns page-full" data-latex="">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math in the World: Heating with gas
</div>
</div>
<div class="callout-body-container callout-body page-columns page-full">
<p><a href="#fig-gas-use-two" class="quarto-xref">Figure&nbsp;<span>9.6</span></a> is a graph of monthly natural gas use in the author’s household versus average temperature during the month. (Natural gas is measured in cubic feet, abbreviated <em>ccf</em>.)</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-gas-use-two" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center" data-cap-location="margin">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-gas-use-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09-assembling-functions_files/figure-html/fig-gas-use-two-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-gas-use-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.6: The amount of natural gas used for heating the author’s home varies with the outside temperature.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The graph looks somewhat like a hockey stick. A sloping straight-line dependence of ccf on temperature for temperatures below <span class="math inline">\(60^\circ\)</span>F and constant for higher temperatures. The shape originates from the dual uses of natural gas. Gas is used for cooking and domestic hot water, the demand for which is more or less independent of outdoor temperature at about 15 ccf per month. Gas is also used for heating the house, but that is needed only when the temperature is less than about <span class="math inline">\(60^\circ\)</span>F.</p>
<p>We can accomplish the hockey-stick shape with a linear combination of the ramp() function and a constant. The ramp function represents gas used for heating, the constant is the other uses of gas (which are modeled as not depending on temperature. Overall, the model is <span class="math display">\[\text{gas}(x) \equiv 4.3\,  \text{ramp}(62-x)  + 15\ .\]</span> Even simpler is the model for the other uses of natural gas: <span class="math display">\[\text{other}(x) \equiv 15\ .\]</span></p>
</div>
</div>
</section>
</section>
<section id="computing-outside-the-domain" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="computing-outside-the-domain"><span class="header-section-number">9.5</span> Computing outside the domain</h2>
<p>Each of our pattern-book functions, with two exceptions, has a domain that is the entire number line <span class="math inline">\(-\infty &lt; x &lt; \infty\)</span>. No matter how big or small is the value of the input, the function has an output. Such functions are particularly nice to work with since we never have to worry about the input going out of bounds.</p>
<p>The two exceptions are:</p>
<ol type="1">
<li>the logarithm function, which is defined only for <span class="math inline">\(0 &lt; x\)</span>.</li>
<li>some of the power-law functions: <span class="math inline">\(x^p\)</span>.
<ul>
<li>When <span class="math inline">\(p\)</span> is negative, the output of the function is undefined when <span class="math inline">\(x=0\)</span>. You can see why with a simple example: <span class="math inline">\(g(x) \equiv x^{-2}\)</span>. Most students had it drilled into them that “division by zero is illegal,” and <span class="math inline">\(g(0) = \frac{1}{0} \frac{1}{0}\)</span>, a double law breaker.</li>
<li>When <span class="math inline">\(p\)</span> is not an integer, that is <span class="math inline">\(p \neq 1, 2, 3, \cdots\)</span> the domain of the power-law function does not include negative inputs. To see why, consider the function <span class="math inline">\(h(x) \equiv x^{1/3}\)</span>.</li>
</ul></li>
</ol>
<div class="rmosaic">
<p>It can be tedious to make sure that you are on the right side of the law when dealing with functions whose domain is not the whole number line. The designers of the hardware that does computer arithmetic, after several decades of work, found a clever system to make it easier. It is a standard part of such hardware that whenever a function is handed an input that is not part of that function’s domain, one of two special “numbers” is returned. To illustrate:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>(<span class="sc">-</span><span class="dv">2</span>)<span class="sc">^</span><span class="fl">0.9999</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] Inf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>NaN</code> stands for “not a number.” Just about any calculation involving <code>NaN</code> will generate <code>NaN</code> as a result, even those involving multiplication by zero or cancellation by subtraction or division.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> For instance:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="sc">*</span> <span class="cn">NaN</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cn">NaN</span> <span class="sc">-</span> <span class="cn">NaN</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="cn">NaN</span> <span class="sc">/</span> <span class="cn">NaN</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Division by zero produces <code>Inf</code>, whose name is reminiscent of “infinity.” <code>Inf</code> infiltrates any calculation in which it takes part:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">*</span> <span class="cn">Inf</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] Inf</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="cn">Inf</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] Inf</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="sc">*</span> <span class="cn">Inf</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="cn">Inf</span> <span class="sc">+</span> <span class="cn">Inf</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] Inf</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="cn">Inf</span> <span class="sc">-</span> <span class="cn">Inf</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="cn">Inf</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To see the benefits of the <code>NaN</code> / <code>Inf</code> system let’s plot out the logarithm function over the graphics domain <span class="math inline">\(-5 \leq x \leq 5\)</span>. Of course, part of that graphics domain, <span class="math inline">\(-5 \leq x \leq 0\)</span> is not in the domain of the logarithm function and the computer is entitled to give us a slap on the wrists. The <code>NaN</code> provides some room for politeness.</p>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>One that does produce a number is <code>NaN^0</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dtkaplan\.github\.io\/MC2\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Modeling/08-parameters.html" class="pagination-link" aria-label="Parameters">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parameters</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Modeling/10-functions-with-multiple-inputs.html" class="pagination-link" aria-label="Functions with multiple inputs">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Functions with multiple inputs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dtkaplan/MC2/edit/main/Modeling/09-assembling-functions.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>