<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>27&nbsp; Polynomials – MOSAIC Calculus</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Differentiation/Differentiation-projects.html" rel="next">
<link href="../Differentiation/25-approximation.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
</head><body class="nav-sidebar floating nav-fixed"><span class="math inline" style="display: none;">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}
\newcommand{\pnorm}{\text{pnorm}}
\newcommand{\dnorm}{\text{dnorm}}
\let\origvec\vec
\let\origmathit\mathit
\let\orighat\hat
\let\origbar\bar
\newcommand{\vec}[1]{\overset{{\rule[-1pt]{0mm}{1mm}}\rightharpoonup}{\mathbf{#1}}}
\newcommand{\bar}[1]{\overset{{\rule[-1pt]{12pt}{.5mm}}}{\mathbf{#1}}}
\newcommand{\mathit}[1]{\underset{\leftharpoondown}{\overset{{\rightharpoonup}}{\large\mathbf #1}}}
\newcommand{\hat}[1]{\widehat{\ \mathbf#1\ }}
\newcommand{\len}[1]{{\|{\mathbf #1}\|}}
\newcommand{\tvec}[1]{\overset{\uparrow}{\mathbf #1}}
\newcommand{\tmat}[1]{\overset{\leftrightarrows}{\mathbf #1}}
\newcommand{\perpendicularto}[2]{#1\!\perp\!#2}
\newcommand{\modeledby}[2]{#1\!\sim\!#2}
\newcommand{\CC}[1]{\color{#648fff}{#1}}
\newcommand{\CE}[1]{\color{#785ef0}{#1}}
\newcommand{\CA}[1]{\color{#dc267f}{#1}}
\newcommand{\CB}[1]{\color{#fe6100}{#1}}
\newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
</span>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../mosaic-calc-style.css">




<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../www/Cover-1.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MOSAIC Calculus</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/dtkaplan/MC2/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../differentiation-part.html">BLOCK II. Differentiation</a></li><li class="breadcrumb-item"><a href="../Differentiation/26-taylor.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Polynomials</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../preliminaries-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PRELIMINARIES</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/01-quant-fun-space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Quantity, function, space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/02-notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/03-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Computing with R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/04-graphs-and-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visualizing functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/05-pattern-book-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pattern-book functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/06-describing-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Describing functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/07-data-and-data-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data and data graphics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../modeling-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK I. Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/01-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parameters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/02-assembling-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Assembling functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/03-functions-with-multiple-inputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Functions with multiple inputs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/04-fitting-by-eye.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fitting features</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/05-low-order-polynomials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Low-order polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/06-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Operations on functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/07-magnitudes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Magnitude</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/08-dimensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Dimensions and units</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/09-modeling-cycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Modeling cycle [DRAFT]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/Modeling-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiation-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK II. Differentiation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/16-continuous-change.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Continuous change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/17-rate-of-change.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Rate of change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/18-evanescent-h.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evanescent h</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/19-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Constructing derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/20-concavity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Concavity and curvature</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/21-cont-and-smooth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Continuity and smoothness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/22-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Derivatives of assembled functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/23-optim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/24-partial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Partial change and the gradient vector</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/25-approximation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Local approximations [DRAFT]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/26-taylor.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/Differentiation-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../linear-combinations-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK III. Vectors and linear combinations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-Vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-linear-combinations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linear combinations of vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-projection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Projection &amp; residual</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-target-problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">The target problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-stat-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Statistical modeling and R<sup>2</sup></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Functions as vectors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../accumulation-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK IV. Accumulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/27-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Change &amp; accumulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/28-visualizing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Totaling the little bits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/29-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Integration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/30-euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Integrals step-by-step</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/31-symbolic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Symbolic anti-differentiation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../dynamics-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK V. Dynamics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-diff-eq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Differential equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Finding a “solution”</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-flow-on-line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Flows on the line</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-flow-on-plane.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Flows on the plane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modeling dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-equilibria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Equilibrium and transient</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-eigen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Eigenvalues, eigenvectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-second-order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Force-balance equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../manifestations-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK VI. Manifestations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Operations on functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-splines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Data-driven functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Optimization and constraint</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Probability and evidence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-future-value.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Present and future value</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-mechanics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Mechanics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../R-mosaic-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setting up R/mosaic</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-polynomial-basics" id="toc-sec-polynomial-basics" class="nav-link active" data-scroll-target="#sec-polynomial-basics"><span class="header-section-number">27.1</span> Basics of polynomials with one input</a></li>
  <li><a href="#multiple-inputs" id="toc-multiple-inputs" class="nav-link" data-scroll-target="#multiple-inputs"><span class="header-section-number">27.2</span> Multiple inputs?</a></li>
  <li><a href="#sec-high-order-approx" id="toc-sec-high-order-approx" class="nav-link" data-scroll-target="#sec-high-order-approx"><span class="header-section-number">27.3</span> High-order approximations</a></li>
  <li><a href="#indeterminate-forms" id="toc-indeterminate-forms" class="nav-link" data-scroll-target="#indeterminate-forms"><span class="header-section-number">27.4</span> Indeterminate forms</a></li>
  <li><a href="#computing-with-indeterminate-forms" id="toc-computing-with-indeterminate-forms" class="nav-link" data-scroll-target="#computing-with-indeterminate-forms"><span class="header-section-number">27.5</span> Computing with indeterminate forms</a></li>
  <li><a href="#drill" id="toc-drill" class="nav-link" data-scroll-target="#drill"><span class="header-section-number">27.6</span> Drill</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">27.7</span> Exercises</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dtkaplan/MC2/edit/main/Differentiation/26-taylor.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../differentiation-part.html">BLOCK II. Differentiation</a></li><li class="breadcrumb-item"><a href="../Differentiation/26-taylor.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Polynomials</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Polynomials</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>A big part of the high-school algebra curriculum is about polynomials. In some ways, this is appropriate since polynomials played an outsized part in the historical development of mathematical theory. Indeed, the so-called “Fundamental theorem of algebra” is about polynomials.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>For modelers, polynomials are a mixed bag. They are very widely used in modeling. Sometimes this is entirely appropriate, for instance the low-order polynomials that are the subject of Chapter <a href="25-approximation.html" class="quarto-xref"><span>Chapter 26</span></a>. The problems come when high-order polynomials are selected for modeling purposes. Building a reliable model with high-order polynomials requires a deep knowledge of mathematics, and introduces serious potential pitfalls. Modern professional modelers learn the alternatives to high-order polynomials, but newcomers often draw on their experience in high-school and give unwarranted credence to polynomials. This chapter attempts to guide you to the ways you are likely to see polynomials in your future work and to help you avoid them when better alternatives are available.</p>
<section id="sec-polynomial-basics" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="sec-polynomial-basics"><span class="header-section-number">27.1</span> Basics of polynomials with one input</h2>
<p>A polynomial is a <strong><em>linear combination</em></strong> of a particular class of functions: power-law functions with non-negative, integer exponents: 1, 2, 3, …. The individual functions are called <strong><em>monomials</em></strong>, a word that echoes the construction of chemical polymers out of monomers; for instance, the material <em>polyester</em> is constructed by chaining together a basic chemical unit called an <a href="https://en.wikipedia.org/wiki/Ester"><em>ester</em></a><em>.</em></p>
<p>In one input, say <span class="math inline">\(x\)</span>, the monomials are <span class="math inline">\(x^1, x^2, x^3\)</span>, and so on. (There is also <span class="math inline">\(x^0\)</span>, but that is better thought of as the constant function.) An <strong><em>n-th order</em></strong> polynomial has monomials up to exponent <span class="math inline">\(n\)</span>. For example, the form of a third-order polynomial is <span class="math display">\[a_0 + a_1 x^1 + a_2 x^2 + a_3 x^3\]</span></p>
<p>The <strong><em>domain</em></strong> of polynomials, like the power-law functions they are assembled from, is the <strong><em>real numbers</em></strong>, that is, the entire number line <span class="math inline">\(-\infty &lt; x &lt; \infty\)</span>. But for the purposes of understanding the shape of high-order polynomials, it is helpful to divide the domain into three parts: a <strong><em>wriggly domain</em></strong> at the center and two <strong><em>tail domains</em></strong> to the right and left of the center.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-wriggly-polynomial" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wriggly-polynomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="26-taylor_files/figure-html/fig-wriggly-polynomial-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wriggly-polynomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.1: A <span class="math inline">\(n\)</span>th-order polynomial can have up to <span class="math inline">\(n-1\)</span> critical points that it wriggles among. A 7-th order polynomial is shown here in which there are six local maxima or minima alternatingly.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-wriggly-polynomial" class="quarto-xref">Figure&nbsp;<span>27.1</span></a> shows a 7th order polynomial—that is, the highest-order term is <span class="math inline">\(x^7\)</span>. In one of the tail domains the function value heads off to <span class="math inline">\(\infty\)</span>, in the other to <span class="math inline">\(-\infty\)</span>. This is a necessary feature of all odd-order polynomials: 1, 3, 5, 7, …</p>
<p>In contrast, for even-order polynomials (2, 4, 6, …) the function value in the two tail domains go in the same direction, either both to <span class="math inline">\(\infty\)</span> (Hands up!) or both to <span class="math inline">\(-\infty\)</span>.</p>
<p>In the wriggly domain in <a href="#fig-wriggly-polynomial" class="quarto-xref">Figure&nbsp;<span>27.1</span></a>, there are six argmins or argmaxes.</p>
<p><strong>An <span class="math inline">\(n\)</span>th-order polynomial can have up to <span class="math inline">\(n-1\)</span> extrema.</strong></p>
<p>Note that the local polynomial approximations in Chapter <a href="25-approximation.html" class="quarto-xref"><span>Chapter 26</span></a> are at most 2nd order and so there is at most 1 wriggle: a unique argmax. If the approximation does not include the quadratic terms (<span class="math inline">\(x^2\)</span> or <span class="math inline">\(y^2\)</span>) then there is no argmax for the function.</p>
</section>
<section id="multiple-inputs" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="multiple-inputs"><span class="header-section-number">27.2</span> Multiple inputs?</h2>
<p>High-order polynomials are rarely used with multiple inputs. One reason is the proliferation of coefficients. For instance, here is the third-order polynomial in two inputs, <span class="math inline">\(x\)</span>, and <span class="math inline">\(y\)</span>. <span class="math display">\[\underbrace{b_0 + b_x x + b_y y}_\text{first-order terms} + \underbrace{b_{xy} x y + b_{xx} x^2 + b_{yy} y^2}_\text{second-order terms} + \underbrace{b_{xxy} x^2 y + b_{xyy} x y^2 + b_{xxx} x^3 + b_{yyy} y^3}_\text{third-order terms}\]</span></p>
<p>This has 10 coefficients. With so many coefficients it is hard to ascribe meaning to any of them individually. And, insofar as some feature of the function does carry meaning in terms of the modeling situation, that meaning is spread out and hard to quantify.</p>
</section>
<section id="sec-high-order-approx" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="sec-high-order-approx"><span class="header-section-number">27.3</span> High-order approximations</h2>
<p>The potential attraction of high-order polynomials is that, with their wriggly interior, they can take on a large number of appearances. This chameleon-like behavior has historically made them the tool of choice for understanding the behavior of approximations. That theory has motivated the use of polynomials for modeling patterns in data, but, paradoxically, has shown that high-order polynomials should <strong>not</strong> be the tool of choice for modeling data.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>Polynomial functions lend themselves well to calculations, since the output from a polynomial function can be calculated using just the basic arithmetic functions: addition, subtraction, multiplication, and division. To illustrate, consider this polynomial: <span class="math display">\[g(x) \equiv x - \frac{1}{6} x^3\]</span> Since the highest-order term is <span class="math inline">\(x^3\)</span> this is a third-order polynomial. (As you will see, we picked these particular coefficients, 0, 1, 0, -1/6, for a reason.) With such simple coefficients the polynomial is easy to handle by mental arithmetic. For instance, for <span class="math inline">\(g(x=1)\)</span> is <span class="math inline">\(5/6\)</span>. Similarly, <span class="math inline">\(g(x=1/2) = 23/48\)</span> and <span class="math inline">\(g(x=2) = 2/3\)</span>. A person of today’s generation would use an electronic calculator for more complicated inputs, but the mathematicians of Newton’s time were accomplished human calculators. It would have been well within their capabilities to calculate, using paper and pencil, <span class="math inline">\(g(\pi/4) = 0.7046527\)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>Our example polynomial, <span class="math inline">\(g(x) \equiv x - \frac{1}{6}x^3\)</span>, graphed in color in <a href="#fig-small-sine" class="quarto-xref">Figure&nbsp;<span>27.2</span></a>, does not look exactly like the sinusoid. If we increased the extent of the graphics domain, the disagreement would be even more striking, since the sinusoid’s output is always in <span class="math inline">\(-1 \leq \sin(x) \leq 1\)</span>, while the polynomial’s tails are heading off to <span class="math inline">\(\infty\)</span> and <span class="math inline">\(-\infty\)</span>. But, for a small interval around <span class="math inline">\(x=0\)</span>, exactly aligns with the sinusoid.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-small-sine" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-small-sine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="26-taylor_files/figure-html/fig-small-sine-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-small-sine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.2: The polynomial <span class="math inline">\(g(x) \equiv x -x^3 / 6\)</span> is remarkably similar to <span class="math inline">\(\sin(x)\)</span> near <span class="math inline">\(x=0\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>It is clear from the graph that the approximation is excellent near <span class="math inline">\(x=0\)</span> and gets worse as <span class="math inline">\(x\)</span> gets larger. The approximation is poor for <span class="math inline">\(x \approx \pm 2\)</span>. We know enough about polynomials to say that the approximation will not get better for larger <span class="math inline">\(x\)</span>; the sine function has a range of <span class="math inline">\(-1\)</span> to <span class="math inline">\(1\)</span>, while the left and right tails of the polynomial are heading off to <span class="math inline">\(\infty\)</span> and <span class="math inline">\(-\infty\)</span> respectively.</p>
<p>One way to measure the quality of the approximation is the <strong><em>error</em></strong> <span class="math inline">\({\cal E}(x)\)</span> which gives, as a function of <span class="math inline">\(x\)</span>, the difference between the actual sinusoid and the approximation: <span class="math display">\[{\cal E}(x) \equiv |\strut\sin(x) - g(x)|\]</span> The absolute value used in defining the error reflects our interest in how <strong><em>far</em></strong> the approximation is from the actual function and not so much in whether the approximation is below or above the actual function. <a href="#fig-sin-error" class="quarto-xref">Figure&nbsp;<span>27.3</span></a> shows <span class="math inline">\({\cal E}(x)\)</span> as a function of <span class="math inline">\(x\)</span>. Since the error is the same on both sides of <span class="math inline">\(x=0\)</span>, only the positive <span class="math inline">\(x\)</span> domain is shown.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-sin-error" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sin-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="26-taylor_files/figure-html/fig-sin-error-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sin-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.3: The error <span class="math inline">\({\cal E}(x)\)</span> of <span class="math inline">\(x - x^3/6\)</span> as an approximation to <span class="math inline">\(\sin(x)\)</span>. Top panel: linear scale. Bottom panel: on a log-log scale.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-sin-error" class="quarto-xref">Figure&nbsp;<span>27.3</span></a> shows that for <span class="math inline">\(x &lt; 0.3\)</span>, the error in the polynomial approximation to <span class="math inline">\(\sin(x)\)</span> is in the 5th decimal place. For instance, <span class="math inline">\(\sin(0.3) = 0.2955202\)</span> while <span class="math inline">\(g(0.3) = 0.2955000\)</span>.</p>
<p>That the graph of <span class="math inline">\({\cal E}(x)\)</span> is a straight-line on log-log scales diagnoses <span class="math inline">\({\cal E}(x)\)</span> as a power law. That is: <span class="math inline">\({\cal E}(x) = A x^p\)</span>. As always for power-law functions, we can estimate the exponent <span class="math inline">\(p\)</span> from the slope of the graph. It is easy to see that the slope is positive, so <span class="math inline">\(p\)</span> must also be positive.</p>
<p>The inevitable consequence of <span class="math inline">\({\cal E}(x)\)</span> being a power-law function with positive <span class="math inline">\(p\)</span> is that <span class="math inline">\(\lim_{x\rightarrow 0} {\cal E}(x) = 0\)</span>. That is, the polynomial approximation <span class="math inline">\(x - \frac{1}{6}x^3\)</span> is <em>exact</em> as <span class="math inline">\(x \rightarrow 0\)</span>.</p>
<p>Throughout this book, we’ve been using straight-line approximations to functions around an input <span class="math inline">\(x_0\)</span>. <span class="math display">\[g(x) = f(x_0) + \partial_x f(x_0) [x-x_0]\]</span> One way to look at <span class="math inline">\(g(x)\)</span> is as a straight-line function. Another way is as a first-order polynomial. This raises the question of what a second-order polynomial approximation should be. Rather than the polynomial matching just the slope of <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(x_0\)</span>, we can arrange things so that the second-order polynomial will also match the curvature of the <span class="math inline">\(f()\)</span>. Since the curvature involves only the first and second derivatives of a function, the polynomial constructed to match both the first and the second derivative will necessarily match the slope and curvature of <span class="math inline">\(f()\)</span>. This can be accomplished by setting the polynomial coefficients appropriately.</p>
<p>Start with a general, second-order polynomial centered around <span class="math inline">\(x_0\)</span>: <span class="math display">\[g(x) \equiv a_0 + a_1 [x-x_0] + a_2 [x - x_0]^2\]</span> The first- and second-derivatives, evaluated at <span class="math inline">\(x=x_0\)</span> are: <span class="math display">\[\partial_x g(x)\left.{\Large\strut}\right|_{x=x_0} = a_1 + 2 a_2 [x  - x_0] \left.{\Large\strut}\right|_{x=x_0} = a_1\]</span> <span class="math display">\[\partial_{xx} g(x)\left.{\Large\strut}\right|_{x=x_0} =  2 a_2\]</span> Notice the 2 in the above expression. When we want to write the coefficient <span class="math inline">\(a_2\)</span> in terms of the second derivative of <span class="math inline">\(g()\)</span>, we will end up with</p>
<p><span class="math display">\[a_2 = \frac{1}{2} \partial_{xx} g(x)\left.{\Large\strut}\right|_{x=x_0}\]</span></p>
<p>To make <span class="math inline">\(g(x)\)</span> approximate <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(x=x_0\)</span>, we need merely set <span class="math display">\[a_1 = \partial_x f(x)\left.{\Large\strut}\right|_{x=x_0}\]</span> and <span class="math display">\[a_2 = \frac{1}{2} \partial_{xx} f(x) \left.{\Large\strut}\right|_{x=x_0}\]</span> This logic can also be applied to higher-order polynomials. For instance, to match the third derivative of <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(x_0\)</span>, set <span class="math display">\[a_3 = \frac{1}{6} \partial_{xxx} f(x)  \left.{\Large\strut}\right|_{x=x_0}\]</span> Remarkably, each coefficient in the approximating polynomial involves only the corresponding order of derivative. <span class="math inline">\(a_1\)</span> involves only <span class="math inline">\(\partial_x f(x)   \left.{\Large\strut}\right|_{x=x_0}\)</span>; the <span class="math inline">\(a_2\)</span> coefficient involves only <span class="math inline">\(\partial_{xx} f(x)     \left.{\Large\strut}\right|_{x=x_0}\)</span>; the <span class="math inline">\(a_3\)</span> coefficient involves only <span class="math inline">\(\partial_{xx} f(x)     \left.{\Large\strut}\right|_{x=x_0}\)</span>, and so on.</p>
<p>Now we can explain where the polynomial that started this section, <span class="math inline">\(x - \frac{1}{6} x^3\)</span> came from and why those coefficients make the polynmomial approximate the sinusoid near <span class="math inline">\(x=0\)</span>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 36%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th>Order</th>
<th><span class="math inline">\(\sin(x)\)</span> derivative</th>
<th><span class="math inline">\(x - \frac{1}{6}x^3\)</span> derivative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td><span class="math inline">\(\sin(x) \left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
<td><span class="math inline">\(\left( 1 - \frac{1}{6}x^3\right)\left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
</tr>
<tr class="even">
<td>1</td>
<td><span class="math inline">\(\cos(x) \left.{\Large\strut}\right|_{x=0} = 1\)</span></td>
<td><span class="math inline">\(\left(1 - \frac{3}{6} x^2\right) \left.{\Large\strut}\right|_{x=0}= 1\)</span></td>
</tr>
<tr class="odd">
<td>2</td>
<td><span class="math inline">\(-\sin(x) \left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
<td><span class="math inline">\(\left(- \frac{6}{6} x\right) \left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
</tr>
<tr class="even">
<td>3</td>
<td><span class="math inline">\(-\cos(x) \left.{\Large\strut}\right|_{x=0} = -1\)</span></td>
<td><span class="math inline">\(- 1\left.{\Large\strut}\right|_{x=0} = -1\)</span></td>
</tr>
<tr class="odd">
<td>4</td>
<td><span class="math inline">\(\sin(x) \left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
<td><span class="math inline">\(0\left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
</tr>
</tbody>
</table>
<p>The first four derivatives of <span class="math inline">\(x - \frac{1}{6} x^3\)</span> exactly match, at <span class="math inline">\(x=0\)</span>, the first four derivatives of <span class="math inline">\(\sin(x)\)</span>.</p>
<p>The polynomial constructed by matching successive derivatives of a function <span class="math inline">\(f(x)\)</span> at some input <span class="math inline">\(x_0\)</span> is called a <strong><em>Taylor polynomial</em></strong>.</p>
<div class="practice">
<p>Let’s construct a 3rd-order Taylor polynomial approximation to <span class="math inline">\(f(x) = e^x\)</span> around <span class="math inline">\(x=0\)</span>.</p>
<p>We know it will be a 3rd order polynomial: <span class="math display">\[g_{\exp}(x) \equiv a_0 + a_1 x + a_2 x^2 + a_3 x^3\]</span> The exponential function is particularly nice for examples because the function value and all its derivatives are identical: <span class="math inline">\(e^x\)</span>. So <span class="math display">\[f(x= 0) = 1\]</span><br>
<span class="math display">\[ \partial_x f(x=0) = 1\]</span> <span class="math display">\[\partial_{xx} f(x=0) = 1\]</span> <span class="math display">\[\partial_{xxx} f(x=0) = 1\]</span> and so on.</p>
<p>The function value and derivatives of <span class="math inline">\(g_{\exp}(x)\)</span> at <span class="math inline">\(x=0\)</span> are: <span class="math display">\[g_{\exp}(x=0) = a_0\]</span> <span class="math display">\[\partial_{x}g_{\exp}(x=0) = a_1\]</span> <span class="math display">\[\partial_{xx}g_{\exp}(x=0) = 2 a_2\]</span></p>
<p><span class="math display">\[\partial_{xxx}g_{\exp}(x=0) = 2\cdot3\cdot a_3 = 6\, a_3\]</span> Matching these to the exponential evaluated at <span class="math inline">\(x=0\)</span>, we get <span class="math display">\[a_0 = 1\]</span> <span class="math display">\[a_1 = 1\]</span> <span class="math display">\[a_2 = \frac{1}{2}\]</span> <span class="math display">\[a_3 = \frac{1}{2 \cdot 3} = \frac{1}{6}\]</span></p>
<p>Result: the 3rd-order Taylor polynomial approximation to the exponential at <span class="math inline">\(x=0\)</span> is <span class="math display">\[g_{\exp}(x) = 1 + x + \frac{1}{2} x^2 +  \frac{1}{2\cdot 3} x^3 +\frac{1}{2\cdot 3\cdot 4} x^4\]</span></p>
<p><a href="#fig-taylor-exp-3" class="quarto-xref">Figure&nbsp;<span>27.4</span></a> shows the exponential function <span class="math inline">\(e^x\)</span> and its 3th-order Taylor polynomial approximation near <span class="math inline">\(x=0\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-taylor-exp-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-taylor-exp-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="26-taylor_files/figure-html/fig-taylor-exp-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-taylor-exp-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.4: The 3th-order Taylor polynomial approximation to <span class="math inline">\(e^x\)</span> arount <span class="math inline">\(x=0\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>The polynomial is exact at <span class="math inline">\(x=0\)</span>. The <strong><em>error</em></strong> <span class="math inline">\({\cal E}(x)\)</span> grows with increasing distance from <span class="math inline">\(x=0\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-taylor-exp-5-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-taylor-exp-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="26-taylor_files/figure-html/fig-taylor-exp-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-taylor-exp-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.5: The error from a 3rd-order Taylor polynomial approximation to <span class="math inline">\(e^x\)</span> around <span class="math inline">\(x=0\)</span> is a power-law function with exponent <span class="math inline">\(4\)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-taylor-exp-5-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-taylor-exp-5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="26-taylor_files/figure-html/fig-taylor-exp-5-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-taylor-exp-5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.6: The error from a 3rd-order Taylor polynomial approximation to <span class="math inline">\(e^x\)</span> around <span class="math inline">\(x=0\)</span> is a power-law function with exponent <span class="math inline">\(4\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The plot of <span class="math inline">\(\log_{10} {\cal E}(x)\)</span> versus <span class="math inline">\(\log_{10} | x |\)</span> in <span class="quarto-unresolved-ref">?fig-taylor-exp-5</span> shows that the error grows from zero at <span class="math inline">\(x=0\)</span> as a power-law function. Measuring the exponent of the power-law from the slope of the graph on log-log axes give <span class="math inline">\({\cal E}(x) = a |x-x_0|^5\)</span>. This is typical of Taylor polynomials: for a polynomial of degree <span class="math inline">\(n\)</span>, the error will grow as a power-law with exponent <span class="math inline">\(n+1\)</span>. This means that the higher is <span class="math inline">\(n\)</span>, the faster <span class="math inline">\(\lim_{x\rightarrow x_0}{\cal E}(x) \rightarrow 0\)</span>. On the other hand, since <span class="math inline">\({\cal E}_x\)</span> is a power law function, as <span class="math inline">\(x\)</span> gets further from <span class="math inline">\(x_0\)</span> the error grows as <span class="math inline">\(\left(x-x_0\right)^{n+1}\)</span>.</p>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" data-latex="">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math in the World: Polynomial models of other functions
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://en.wikipedia.org/wiki/Brook_Taylor">Brooke Taylor</a> (1685-1731), a near contemporary of Newton, published his work on approximating polynomials in 1715. Wikipedia reports: “[T]he importance of [this] remained unrecognized until 1772, when Joseph-Louis Lagrange realized its usefulness and termed it ‘the main [theoretical] foundation of differential calculus’.”<a href="https://en.wikipedia.org/wiki/Brook_Taylor#/media/File:Taylor_Brook_Goupy_NPG.jpg">Source</a></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-brook-taylor" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-brook-taylor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="www/Brook_Taylor.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-brook-taylor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.7: Brook Taylor
</figcaption>
</figure>
</div>
</div>
</div>
<p>Due to the importance of Taylor polynomials in the development of calculus, and their prominence in many calculus textbooks, many students assume their use extends to constructing models from data. They also assume that third- and higher-order monomials are a good basis for modeling data. Both these assumptions are wrong. Least squares is the proper foundation for working with data.</p>
<p>Taylor’s work preceded by about a century the development of techniques for working with data. One of the pioneers in these new techniques was Carl Friedrich Gauss (1777-1855), after whom the gaussian function is named. Gauss’s techniques are the foundation of an incredibly important statistical method that is ubiquitous today: <strong><em>least squares</em></strong>. Least squares provides an entirely different way to find the coefficients on approximating polynomials (and an infinite variety of other function forms). The R/mosaic <code>fitModel()</code> function for polishing parameter estimates is based on least squares. In Block 5, we will explore least squares and the mathematics underlying the calculations of least-squares estimates of parameters.</p>
</div>
</div>
</section>
<section id="indeterminate-forms" class="level2" data-number="27.4">
<h2 data-number="27.4" class="anchored" data-anchor-id="indeterminate-forms"><span class="header-section-number">27.4</span> Indeterminate forms</h2>
<p>Let’s return to an issue that has bedeviled calculus students since Newton’s time. The example we will use is the function <span class="math display">\[\text{sinc}(x)  \equiv \frac{\sin(x)}{x}\]</span></p>
<p>The sinc() function (pronounced “sink”) is still important today, in part because of its role in converting discrete-time measurements (as in an mp3 recording of sound) into continuous signals.</p>
<p>What is the value of <span class="math inline">\(\text{sinc}(0)\)</span>? One answer, favored by arithmetic teachers is that <span class="math inline">\(\text{sinc}(0)\)</span> is meaningless, because it involves division by zero.</p>
<p>On the other hand, <span class="math inline">\(\sin(0) = 0\)</span> as well, so the sinc function evaluated at zero involves 0/0. This quotient is called an <strong><em>indeterminant form</em></strong>. The logic is this: Suppose we assume that <span class="math inline">\(0/0 = b\)</span> for some number <span class="math inline">\(b\)</span>. then <span class="math inline">\(0 = 0 \times b = 0\)</span>. So any value of <span class="math inline">\(b\)</span> would do; the value of <span class="math inline">\(0/0\)</span> is “indeterminant.”</p>
<p>Still another answer is suggested by plotting out sinc(<span class="math inline">\(x\)</span>) near <span class="math inline">\(x=0\)</span> and reading the value off the graph: sinc(0) = 1.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">sin</span>(x) <span class="sc">/</span> x <span class="sc">~</span> x, <span class="fu">bounds</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>)), <span class="at">npts=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sinc-near-zero" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sinc-near-zero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="26-taylor_files/figure-html/fig-sinc-near-zero-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sinc-near-zero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.8: To judge from this plot, <span class="math inline">\(\sin(0) = 1\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The graph of sinc() looks smooth and the shape makes sense. Even if we zoom in very close to <span class="math inline">\(x=0\)</span>, the graph continues to look smooth. We call such functions <strong><em>well behaved</em></strong>.</p>
<p>Compare the well-behaved sinc() to a very closely related function (which does not seem to be so important in applied work): <span class="math inline">\(\frac{\sin(x)}{x^3}\)</span>.</p>
<p>Both <span class="math inline">\(\sin(x)/x\)</span> and <span class="math inline">\(\sin(x) / x^3\)</span>, evaluated at <span class="math inline">\(x=0\)</span> involve a divide by zero. Both are indeterminate forms 0/0 at <span class="math inline">\(x=0\)</span>. But the graph of <span class="math inline">\(\sin(x) / x^3\)</span> (see <span class="quarto-unresolved-ref">?fig-sinc2</span>) is not we will behaved. <span class="math inline">\(\sin(x) / x^3\)</span> does not have any particular value at <span class="math inline">\(x=0\)</span>; instead, it has an asymptote.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">sin</span>(x) <span class="sc">/</span> x <span class="sc">~</span> x, <span class="fu">bounds</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">npts=</span><span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_refine</span>(<span class="fu">scale_y_log10</span>())</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">sin</span>(x) <span class="sc">/</span> x<span class="sc">^</span><span class="dv">3</span> <span class="sc">~</span> x, <span class="fu">bounds</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">npts=</span><span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_refine</span>(<span class="fu">scale_y_log10</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sinc2-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sinc2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="26-taylor_files/figure-html/fig-sinc2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sinc2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.9: Zooming in around the division by zero. Left: The graph of <span class="math inline">\(\sin(x)/x\)</span> versus <span class="math inline">\(x\)</span>. Right: The graph of <span class="math inline">\(\sin(x)/x^2\)</span>. The vertical scales on the two graphs are utterly different.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-sinc2-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sinc2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="26-taylor_files/figure-html/fig-sinc2-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sinc2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.10: Zooming in around the division by zero. Left: The graph of <span class="math inline">\(\sin(x)/x\)</span> versus <span class="math inline">\(x\)</span>. Right: The graph of <span class="math inline">\(\sin(x)/x^2\)</span>. The vertical scales on the two graphs are utterly different.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Since both <span class="math inline">\(\sin(x)/x\left.{\Large\strut}\right|_{x=0}\)</span> and <span class="math inline">\(\sin(x)/x^3\left. {\Large\strut}\right|_{x=0}\)</span> involve a divide-by-zero, the answer to the utterly different behavior of the two functions is not to be found at zero. Instead, it is to be found <strong><em>near</em></strong> zero. For any non-zero value of <span class="math inline">\(x\)</span>, the arithmetic to evaluate the functions is straight-forward. Note that <span class="math inline">\(\sin(x) / x^3\)</span> starts its mis-behavior away from zero. The slope of <span class="math inline">\(\sin(x) / x^3\)</span> is very large near <span class="math inline">\(x=0\)</span>, while the slope of <span class="math inline">\(\sin(x) / x\)</span> smoothly approaches zero.</p>
<p>Since we are interested in behavior <strong>near</strong> <span class="math inline">\(x=0\)</span>, a useful technique is to approximate the numerator and denominator of both functions by polynomial approximations.</p>
<ul>
<li><span class="math inline">\(\sin(x) \approx x - \frac{1}{6} x^3\)</span> near <span class="math inline">\(x=0\)</span></li>
<li><span class="math inline">\(x\)</span> is already a polynomial.</li>
<li><span class="math inline">\(x^3\)</span> is already a polynomial.</li>
</ul>
<p>Remember, these approximations are <strong>exact</strong> as <span class="math inline">\(x\)</span> goes to zero. So sufficiently close to zero,</p>
<p><span class="math display">\[\frac{\sin(x)}{x} = \frac{x - \frac{1}{6} x^3}{x} = 1 + \frac{1}{6} x^2\]</span> Even at <span class="math inline">\(x=0\)</span>, there is nothing indeterminant about <span class="math inline">\(1 + x^2/6\)</span>; it is simply 1.</p>
<p>Compare this to the polynomial approximation to <span class="math inline">\(\sin(x) / x^3\)</span>: <span class="math display">\[\frac{\sin(x)}{x^3} = \frac{x - \frac{1}{6} x^3}{x^3} = \frac{1}{x^2} - \frac{1}{6}\]</span></p>
<p>Evaluating this at <span class="math inline">\(x=0\)</span> involves division by zero. No wonder it is badly behaved.</p>
<p>The procedure for checking whether a function involving division by zero behaves well or poorly is described in the first-ever calculus textbook, published in 1697. The title (in English) is: <em>The analysis into the infinitely small for the understanding of curved lines</em>. In honor of the author, the Marquis de l’Hospital, the procedure is called <strong><em>l’Hopital’s rule</em></strong>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>Conventionally, the relationship is written <span class="math display">\[\lim_{x\rightarrow x_0} \frac{u(x)}{v(x)} = \lim_{x\rightarrow x_0} \frac{\partial_x u(x)}{\partial_x v(x)}\]</span></p>
<p>Let’s try this out with our two example functions around <span class="math inline">\(x=0\)</span>:</p>
<p><span class="math display">\[\lim_{x\rightarrow 0} \frac{\sin(x)}{x} = \frac{\lim_{x\rightarrow 0} \cos(x)}{\lim_{x \rightarrow 0} 1} = \frac{1}{1} = 1\]</span></p>
<p><span class="math display">\[\lim_{x\rightarrow 0} \frac{\sin(x)}{x^3} = \frac{\lim_{x\rightarrow 0} \cos(x)}{\lim_{x \rightarrow 0} 3x^2} = \frac{1}{0} \ \ \text{indeterminate}!\]</span></p>
</section>
<section id="computing-with-indeterminate-forms" class="level2" data-number="27.5">
<h2 data-number="27.5" class="anchored" data-anchor-id="computing-with-indeterminate-forms"><span class="header-section-number">27.5</span> Computing with indeterminate forms</h2>
<p>In the early days of electronic computers, division by zero would cause a fault in the computer, often signaled by stopping the calculation and printing an error message to some display. This was inconvenient, since programmers did not always forsee division-by-zero situations and avoid them.</p>
<p>As you’ve seen, modern computers have adopted a convention that simplifies programming considerably. Instead of stopping the calculation, the computer just carries on normally, but produces as a result one of two indeterminant forms: <code>Inf</code> and <code>NaN</code>.</p>
<p><code>Inf</code> is the output for the simple case of dividing zero into a non-zero number, for instance:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span><span class="sc">/</span><span class="dv">0</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] Inf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>NaN</code>, standing for “not a number,” is the output for more challenging cases: dividing zero into zero, or multiplying <code>Inf</code> by zero, or dividing <code>Inf</code> by <code>Inf</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="sc">/</span><span class="dv">0</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="sc">*</span> <span class="cn">Inf</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cn">Inf</span> <span class="sc">/</span> <span class="cn">Inf</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NaN</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The brilliance of the idea is that any calculation that involves <code>NaN</code> will return a value of <code>NaN</code>. This might seem to get us nowhere. But most programs are built out of other programs, usually written by other people interested in other applications. You can use those programs (mostly) without worrying about the implications of a divide by zero. If it is important to respond in some particularly way, you can always check the result for being <code>NaN</code> in your own programs. (Much the same is true for <code>Inf</code>, although dividing a non-<code>Inf</code> number by <code>Inf</code> will return 0.)</p>
<p>Plotting software will often treat <code>NaN</code> values as “don’t plot this.” that is why it is possible to make a sensible plot of <span class="math inline">\(\sin(x)/x\)</span> even when the plotting domain includes zero.</p>
</section>
<section id="drill" class="level2" data-number="27.6">
<h2 data-number="27.6" class="anchored" data-anchor-id="drill"><span class="header-section-number">27.6</span> Drill</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 1**  Here is a function $f(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-01.png"&gt;&lt;br&gt; In the Taylor polynomial approximation to $f(x)$ centered at $x=-2$, what will be the sign of the coefficient on the first-order term. Choose the best answer.   </code></pre>
<ol type="a">
<li>positive</li>
<li>zero</li>
<li>negative</li>
<li>no such coefficient exists in a Taylor polynomial</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 2**  Here is a function $f(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-01.png"&gt;&lt;br&gt; In the Taylor polynomial approximation to $f(x)$ centered at $x=1$, what will be the sign of the coefficient on the first-order term. Choose the best answer.   </code></pre>
<ol type="a">
<li>positive</li>
<li>zero</li>
<li>negative</li>
<li>no such coefficient exists in a Taylor polynomial</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 3**  Here is a function $f(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-01.png"&gt;&lt;br&gt; In the Taylor polynomial approximation to $f(x)$ centered at $x=1$, what will be the sign of the coefficient on the second-order term. Choose the best answer.   </code></pre>
<ol type="a">
<li>positive</li>
<li>zero</li>
<li>negative</li>
<li>no such coefficient exists in a Taylor polynomial</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 4**  Here is a function $f(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-01.png"&gt;&lt;br&gt; In the Taylor polynomial approximation to $f(x)$ centered at $x=-4$, what will be the sign of the coefficient on the first-order term. Choose the best answer.   </code></pre>
<ol type="a">
<li>positive</li>
<li>zero</li>
<li>negative</li>
<li>no such coefficient exists in a Taylor polynomial</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 5**  Here is a function $f(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-01.png"&gt;&lt;br&gt; In the Taylor polynomial approximation to $f(x)$ centered at $x=4$, what will be the sign of the coefficient on the second-order term. Choose the best answer.   </code></pre>
<ol type="a">
<li>positive</li>
<li>zero</li>
<li>negative</li>
<li>no such coefficient exists in a Taylor polynomial</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 6**  Here is a function $f(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-01.png"&gt;&lt;br&gt; In the Taylor polynomial approximation to $f(x)$ centered at $x=4$, what will be the sign of the coefficient on the constant (zeroth-order) term. Choose the best answer.   </code></pre>
<ol type="a">
<li>positive</li>
<li>zero</li>
<li>negative</li>
<li>no such coefficient exists in a Taylor polynomial</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 7**  Here is a function $f(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-01.png"&gt;&lt;br&gt; In the Taylor polynomial approximation to $f(x)$ centered at $x=3$, what will be the sign of the coefficient on the second-order term. Choose the best answer.   </code></pre>
<ol type="a">
<li>positive</li>
<li>zero</li>
<li>negative</li>
<li>no such term exists in a Taylor polynomial</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 8**  Here is a function $f(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-01.png"&gt;&lt;br&gt; In the Taylor polynomial approximation to $f(x)$ centered at $x=0$, what will be the sign of the coefficient on the reciprocal term. Choose the best answer.   </code></pre>
<ol type="a">
<li>positive</li>
<li>zero</li>
<li>negative</li>
<li>no such term exists in a Taylor polynomial</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 9**  Here is a function $g(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-03.png"&gt;&lt;br&gt; Two Taylor polynomials, centered on the same $x$ are shown. One is fifth-order, the other is third-order. Which is which?   </code></pre>
<ol type="a">
<li>The third-order polynomial is brown.</li>
<li>The third-order polynomial is magenta.</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part 10**  Here is a function $g(x)$: &lt;br&gt;&lt;img src="https://raw.githubusercontent.com/dtkaplan/Zdrill/main/inst/Polynomials/poly-02.png"&gt;&lt;br&gt; with a Taylor polynomial shown in magenta. What is the order of the polynomial?   </code></pre>
<p>zero one two three four</p>
</div>
</div>
</section>
<section id="exercises" class="level2" data-number="27.7">
<h2 data-number="27.7" class="anchored" data-anchor-id="exercises"><span class="header-section-number">27.7</span> Exercises</h2>
<section id="exercise-27.01" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.01">Exercise 27.01</h4>
<p>The Taylor polynomial for <span class="math inline">\(e^x\)</span> has an especially lovely formula: <span class="math display">\[p(x) = 1 + \frac{x}{1!} + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + \cdots\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  In the above formula, the center $x_0$ does not appear. Why not? </code></pre>
<ol type="a">
<li>Having a center is not a requirement for a Taylor polynomial.</li>
<li>There is a center, <span class="math inline">\(x_0 = 1\)</span>, but terms like <span class="math inline">\(x_0 x^2\)</span> were simplified to <span class="math inline">\(x^2\)</span>.</li>
<li>There is a center, <span class="math inline">\(x_0 = 0\)</span>, but the terms like <span class="math inline">\((x-x_0)^2\)</span> were simplified to <span class="math inline">\(x^2\)</span>.</li>
</ol>
</div>
</div>
</section>
<section id="exercise-27.02" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.02">Exercise 27.02</h4>
<p>Here is a Taylor polynomial: <span class="math display">\[p(x) = e + \frac{e}{1!} (x-1) + \frac{e}{2!} (x-1)^2 + \cdots\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  Where is the center $x_0$ of this polynomial? </code></pre>
<p><span class="math inline">\(x_0 = -2\)</span> <span class="math inline">\(x_0 = -1\)</span> <span class="math inline">\(x_0 = 0\)</span> <span class="math inline">\(x_0=1\)</span> <span class="math inline">\(x_0 = 2\)</span></p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part B**  Your roommate suggests that $p(x)$ is a Taylor expansion of $e^x$ around $x=1$. Is he right? </code></pre>
<ol type="a">
<li>No, a polynomial does not have functions like <span class="math inline">\(e\)</span>.</li>
<li>Yes. The center is <span class="math inline">\(x_0 = 1\)</span>.</li>
<li>Not really. The formula suggests that the center is <span class="math inline">\(x_0=1\)</span> but the coefficients are wrong.</li>
</ol>
</div>
</div>
</section>
<section id="exercise-27.03" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.03">Exercise 27.03</h4>
<p>Consider the function <span class="math inline">\(f(x) \equiv (x - 3)^2\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  Using ordinary algebra, $f(x)$ can be expanded as $(x^2 - 6 x -9)$. Consider $$p(x) = -9 - 6 x + x^2 .$$ Is $p()$ a Taylor polynomial expansion of $f(x)$? </code></pre>
<ol type="a">
<li>Yes, with a center at <span class="math inline">\(x_0 = 0\)</span></li>
<li>Yes, with a center at <span class="math inline">\(x_0 = 3\)</span></li>
<li>No, because there are no factorials involved</li>
</ol>
</div>
</div>
</section>
<section id="exercise-27.04" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.04">Exercise 27.04</h4>
<p>Here’s the Taylor polynomial expansion of <span class="math inline">\(\sin(x)\)</span> about a center <span class="math inline">\(x_0\)</span>: <span class="math display">\[p(x) = 1/2 - \frac{\sqrt{3}/{2}}{2!} (x - x_0)^2 + \frac{1/2}{4!} (x - x_0)^4 + \cdots\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  Which of these is the numerical value of $x_0$? (Hint: Remember that the coefficients involve the function and its derivatives evaluated at $x_0$ as described in Section \@ref(high-order-approx).) </code></pre>
<p><span class="math inline">\(\pi/6\)</span> <span class="math inline">\(\pi/3\)</span> <span class="math inline">\(\pi/2\)</span> <span class="math inline">\(\pi\)</span></p>
</div>
</div>
<p>Problem with Differentiation Exercises/camel-sing-futon</p>
</section>
<section id="exercise-27.06" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.06">Exercise 27.06</h4>
<p>Consider the function <span class="math display">\[f(x)\equiv \sin(x-\frac{\pi}{6})\]</span> and its 3rd order Taylor polynomial approximation, <span class="math inline">\(T(x)\)</span>. We will implement both in R/mosaic:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">sin</span>(x<span class="sc">-</span>pi<span class="sc">/</span><span class="dv">6</span>)<span class="sc">~</span>x)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="sc">-</span>.<span class="dv">5</span><span class="sc">+</span>x<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="dv">2</span><span class="fl">+.25</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">3</span>))<span class="sc">~</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this exercise, we want to figure out the extent of the interval in which <span class="math inline">\(T(x)\)</span> is within <span class="math inline">\(0.05\)</span> of <span class="math inline">\(f(x)\)</span>. We can do this by plotting <span class="math inline">\(T(x)\)</span> and also the two functions <span class="math inline">\(f(x)+0.05\)</span> and <span class="math inline">\(f(x)-0.05\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">f</span>(x)<span class="sc">+</span>.<span class="dv">05</span><span class="sc">~</span>x,<span class="fu">bounds</span>(<span class="at">x=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>))<span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">f</span>(x)<span class="sc">-</span>.<span class="dv">05</span><span class="sc">~</span>x)<span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">T</span>(x)<span class="sc">~</span>x,<span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="26-taylor_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  Find the full interval of the domain of $x$ for which $f(x) - 0.05 &lt; T(x) &lt; f(x) + 0.05$. (Hint: you may need to modify the plotting commands.) </code></pre>
<p><span class="math inline">\(x\in(-1.1,1,1)\)</span> <span class="math inline">\(x\in(-1.1,1.5)\)</span> <span class="math inline">\(x\in(-1.5,1.1)\)</span> <span class="math inline">\(x\in(-1.5,1.5)\)</span></p>
</div>
</div>
</section>
<section id="exercise-27.07" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.07">Exercise 27.07</h4>
<p>With very high-order derivatives, it can be awkward to use a notation with repeated subscripts, like <span class="math inline">\(\partial_{xxxxx} f(x)\)</span>. Another notation often encountered is <span class="math inline">\(f^{(5)}\)</span>, where the integer in the superscript tells the order of the derivative. We will use that notation in this problem.</p>
<p>For a function <span class="math inline">\(f(x)\)</span> and its derivatives <span class="math inline">\(f^{(1)}(x)\)</span>, <span class="math inline">\(f^{(2)}(x)\)</span>, … the Taylor polynomial <span class="math inline">\(p(x)\)</span> centered on <span class="math inline">\(x_0\)</span> is</p>
<p><span class="math display">\[p(x) \equiv f(x_0) + \frac{f^{(1)}(x_0)}{1!} (x - x_0)^1 +
\frac{f^{(2)}(x_0)}{2!} (x - x_0)^2 + \cdots\]</span></p>
<p>A Taylor polynomial, like all polynomials, is a linear combination of basic functions.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  Which of these are the basic functions being linearly combined in a Taylor polynomial? </code></pre>
<ol type="a">
<li><span class="math inline">\(f(x), f^{(1)}(x), f^{(2)}(x), \ldots\)</span></li>
<li><span class="math inline">\(f(x_0), f^{(1)}(x_0), f^{(2)}(x_0), \ldots\)</span></li>
<li><span class="math inline">\(f(x_0), \frac{f^{(1)}(x_0)}{1!},  \frac{f^{(2)}(x_0)}{2!}, \ldots\)</span></li>
<li><span class="math inline">\((x-x_0), (x - x_0)^2, \ldots\)</span></li>
</ol>
</div>
</div>
</section>
<section id="exercise-27.08" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.08">Exercise 27.08</h4>
<p>It is worth remembering the first couple of terms in the Taylor polynomial approximation of the sine and cosine functions.</p>
<p><span class="math display">\[\begin{eqnarray}
\sin(x) &amp;\approx &amp; x - \frac{1}{2\cdot 3} x^3\\
\cos(x) &amp;\approx &amp; 1 - \frac{1}{2} x^2$$
\end{eqnarray}\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  What is the order of the approximation to $\sin(x)$ given above? </code></pre>
<p>First Second Third Fourth</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part B**  What is the order of the approximation to $\cos(x)$ given above? </code></pre>
<p>First Second Third Fourth</p>
</div>
</div>
<p>Here are several different quantities to calculate involving limits. You will carry out the calculation by substituting the Taylor Polynomials given above, cancelling out <span class="math inline">\(x\)</span> terms as permitted, and examining if the resulting formula makes sense. If it does, calculate the numerical value of the limit.</p>
<p>Example: <span class="math display">\[\lim_{x \rightarrow 0} \frac{1 - \sin(x)}{x^2} \ \ \text{becomes}\ \ \lim_{x \rightarrow 0} \frac{1 - x + x^3/6}{x} = \lim_{x \rightarrow 0} \left(\strut\frac{1}{x} - 1 + \frac{x^2}{6}\right)\]</span> The <span class="math inline">\(-1\)</span> and <span class="math inline">\(x^2/6\)</span> terms are perfectly sensible in the limit as <span class="math inline">\(x \rightarrow 0\)</span>, but the <span class="math inline">\(1/x\)</span> term implies division by zero. There is no numerical value for the limit.</p>
<p><span class="math display">\[\text{a.}\ \ \lim_{x\rightarrow 0}\frac{1 - \cos(x)}{x}\]</span> <span class="math display">\[\text{b.}\ \ \lim_{x\rightarrow 0}\frac{1 - \cos(x)}{x^2}\]</span></p>
<p><span class="math display">\[\text{c.}\ \ \lim_{x\rightarrow 0}\frac{\sin(x)}{x}\]</span></p>
</section>
<section id="exercise-27.09" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.09">Exercise 27.09</h4>
<p>Each of the three functions graphed below is a simple power-law function that can be written <span class="math inline">\(\left[x-x_0\right]^n\)</span>. The three functions have different values for <span class="math inline">\(x_0\)</span> and for <span class="math inline">\(n\)</span>.</p>
<div class="cell" data-layout-align="center">
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="26-taylor_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  For the $\color{blue}{  ext{blue}}$ function, what is $x_0$? </code></pre>
<p>0 1 2 3 4 5</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part B**  For the $\color{blue}{  ext{blue}}$ function, what is the order of the polynomial? </code></pre>
<p>0 1 2 3 4 5</p>
</div>
</div>
<hr>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part C**  For the $\color{orange}{    ext{orange}}$ function, what is $x_0$? </code></pre>
<p>0 1 2 3 4 5</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part D**  For the $\color{orange}{    ext{orange}}$ function, what is the order of the polynomial? </code></pre>
<p>0 1 2 3 4 5</p>
</div>
</div>
<hr>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part E**  For the $\color{magenta}{   ext{magenta}}$ function, what is $x_0$? </code></pre>
<p>-2 -1 0 1 2 3</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part F**  For the $\color{magenta}{   ext{magenta}}$ function, what is the order of the polynomial? </code></pre>
<p>0 1 2 3 4 5</p>
</div>
</div>
</section>
<section id="exercise-27.10" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.10">Exercise 27.10</h4>
<p>At <span class="math inline">\(x=0\)</span>, the value of <span class="math inline">\(x \ln(x)\)</span> is indeterminate, having the form <span class="math inline">\(0 \cdot \infty\)</span>.</p>
<p>Using a sandbox, plot out <span class="math inline">\(x \ln(x)\)</span> over the domain <span class="math inline">\(0 &lt; x &lt; \frac{1}{2}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  From the graph, determine $\lim_{x\rightarrow 0} x \ln(x()$. Choose the correct answer. </code></pre>
<p>-0.2 0 0.1 0.5 not well behaved</p>
</div>
</div>
<p>Use l’Hopital’s rule to confirm that <span class="math inline">\(\lim_{x\rightarrow 0} x \ln(x()\)</span> exists. Here, the rule has the form:</p>
<p><span class="math display">\[\lim_{x\rightarrow 0} x \cdot \ln(x) = [\lim_{x\rightarrow 0} \partial_x x] \cdot
[\lim_{x\rightarrow 0} \partial_x \ln(x)]\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part B**  Does the application of l'Hopital's rule confirm the result from graphing the function? </code></pre>
<p>Yes No</p>
</div>
</div>
</section>
<section id="exercise-27.11" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-27.11">Exercise 27.11</h4>
<p>We would like to write a Taylor-series polynomial for <span class="math inline">\(\dnorm(x)\)</span>. To do this, we will need the numbers <span class="math display">\[\dnorm(x_0),\ \ \partial_x \dnorm(x_0),\ \ \partial_{xx} \dnorm(x_0),\ \ \partial_{xxx} \dnorm(x_0), ...\]</span> Here are the functions for the derivatives</p>
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th>Order</th>
<th>formula for derivative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0th</td>
<td><span class="math inline">\(\dnorm(x)\)</span></td>
</tr>
<tr class="even">
<td>1st</td>
<td><span class="math inline">\(\left[{\large\strut}-x\right]\dnorm(x)\)</span></td>
</tr>
<tr class="odd">
<td>2nd</td>
<td><span class="math inline">\(\left[{\large\strut}x^2 - 1\right]\dnorm(x)\)</span></td>
</tr>
<tr class="even">
<td>3rd</td>
<td><span class="math inline">\(\left[{\large\strut}3x - x^3\right]\dnorm(x)\)</span></td>
</tr>
<tr class="odd">
<td>4th</td>
<td><span class="math inline">\(\left[{\large\strut}3\,x^2-x^4     \right]\dnorm(x)\)</span></td>
</tr>
<tr class="even">
<td>5th</td>
<td><span class="math inline">\(\left[{\large\strut}3-6\,x^3 + x^5     \right]\dnorm(x)\)</span></td>
</tr>
<tr class="odd">
<td>6th</td>
<td><span class="math inline">\(\left[{\large\strut}-15\,x^2 + 10\,x^4-x^6     \right]\dnorm(x)\)</span></td>
</tr>
<tr class="even">
<td>7th</td>
<td><span class="math inline">\(\left[{\large\strut}-15 + 45\,x^3-15\,x^5 + x^7     \right]\dnorm(x)\)</span></td>
</tr>
<tr class="odd">
<td>8th</td>
<td><span class="math inline">\(\left[{\large\strut}105\,x^2-105\,x^4 + 21\,x^6-x^8     \right]\dnorm(x)\)</span></td>
</tr>
</tbody>
</table>
<ol type="1">
<li>Write a Taylor polynomial function for <span class="math inline">\(\dnorm(x)\)</span> around <span class="math inline">\(x_0=0\)</span>). To do this, you will have to evaluate each of the 9 formulas above at <span class="math inline">\(x=0\)</span>, producing a number. For example, the first five formulas will give 0.3989, 0, -0.3989, 0, 1.1968. This would expand into the following Taylor function:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>T_at_0 <span class="ot">=</span> <span class="fu">makeFun</span>(<span class="fl">0.3989</span> <span class="sc">+</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span><span class="sc">*</span>(x<span class="sc">-</span>x0) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">-</span> <span class="fl">0.3989</span><span class="sc">*</span>(x<span class="sc">-</span>x0)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span><span class="sc">*</span>(x<span class="sc">-</span>x0)<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">1.1968</span><span class="sc">*</span>(x<span class="sc">-</span>x0)<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">4</span>) <span class="sc">~</span> x, </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x0=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You will need to add in the 6th, 7th, and 8th terms.</p>
<ol start="2" type="1">
<li><p>Plot <code>T_at_0(x) ~ x</code> over the domain <span class="math inline">\(0 \leq x \leq 2\)</span>, and pipe the result to a slice-plot of <code>dnorm(x) ~ x</code> so that you can compare the two plots.</p></li>
<li><p>Define another function <code>T_at_1()</code> which will be much like <code>T_at_zero()</code> but with <code>x0=1</code> and the coefficients changed to be the formulas evaluated at <span class="math inline">\(x=1\)</span>.</p></li>
<li><p>Add a layer showing <code>T_at_1()</code> to your previous plot.</p></li>
</ol>
<p>Say over what domain <code>T_at_0()</code> is a good approximation to <code>dnorm()</code> and over what domain <code>T_at_1()</code> is a good approximation to <code>dnorm()</code>. Do the two domains overlap?</p>
<ol start="5" type="1">
<li>Write a piecewise function of this form:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">ifelse</span>(<span class="fu">abs</span>(x) <span class="sc">&lt;</span> <span class="fl">0.5</span>, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">T_at_0</span>(<span class="fu">abs</span>(x)), </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">T_at_1</span>(<span class="fu">abs</span>(x))) <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot this out on top of <code>dnorm()</code> to show whether <code>T()</code> is a good approximation to <code>dnorm()</code>.</p>
<p>You could continue on to define <code>T_at_2()</code> and incorporate that into the piecewise <code>T()</code>, and so on, to construct an approximation to <code>dnorm()</code> that is accurate over a larger domain.</p>
<!--

RECURSIVE CONSTRUCTION OF THE POLYNOMIALS that multiply dnorm(x) for the successive derivatives.

::: {.cell layout-align="center"}

:::

-->
<!--
## Fitting polynomials

Taylor polynomials provide a means to approximate continuous and smooth functions around a center $x_0$. So long as $x$ is very close to $x_0$, the approximation will be excellent. But Taylor polynomials aren't a solution to every problem. Consider the piecewise continuous function, $ramp(x-1)$, in @fig-ramp-Taylor.






::: {.cell layout-align="center"}
::: {.cell-output-display}
![A piecewise continuous ramp function (gray) together with its Taylor polynomial (magenta) centered on $x_0 = 0$.](26-taylor_files/figure-html/ramp-Taylor-1.png){fig-align='center' width=90%}
:::
:::





The value of $ramp(x-1) \left.\Large\right|_{x=0}$ is zero, as is the value of the first, second, third, and every other derivative. Whatever we choose for the order $n$ of the Taylor polynomial, it will be $\text{Taylor(x) = 0}$. That is an excellent approximation to $ramp(x-1)$ around $x=0$! But it misses the point of $ramp()$ entirely.

Or consider the problem that introduced this chapter: finding an arithmetic process to evaluate $\sin(x)$. As it happens, we only need to be able to evaluate $\sin(x)$ on the interval $0 \leq x \leq \pi/2$.^[If $x$ is outside this range, add or subtract a multiple $k \in [\ldots, -2, -1, 0, 1, 2, \ldots]$ of $\pi$ so  $0 \leq x - k \pi \leq \pi$. Then, if $\pi/2 \leq (x - k \pi)$, calculate $\sin(\pi - (x - k \pi))$ 

FIT TO PART OF SINE






::: {.cell layout-align="center"}

```{.r .cell-code}
Pts <- tibble(x = seq(0, pi/2, length=1000), y = sin(x))
mod <- lm(y ~ x + I(x*x) + I(x*x*x) - 1, data = Pts)
mod
## 
## Call:
## lm(formula = y ~ x + I(x * x) + I(x * x * x) - 1, data = Pts)
## 
## Coefficients:
##            x      I(x * x)  I(x * x * x)  
##      1.01642      -0.05629      -0.11892
fmod <- makeFun(mod)
slice_plot(sin(x) ~ x, bounds(x=c(0, pi/2)), size=3, alpha=0.25) %>%
  slice_plot(fmod(x) ~ x, color="magenta")
```

::: {.cell-output-display}
![](26-taylor_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=90%}
:::

```{.r .cell-code}
slice_plot(sin(x) - fmod(x) ~ x, bounds(x=c(0, pi/2))) %>%
  slice_plot(sin(x) - (x - x^3/6) ~ x, color="green")
```

::: {.cell-output-display}
![](26-taylor_files/figure-html/unnamed-chunk-14-2.png){fig-align='center' width=90%}
:::
:::






-->


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The fundamental theorem says that an order-n polynomial has n roots (including multiplicities).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The mathematical background needed for those better tools won’t be available to us until Block 5, when we explore linear algebra.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Unfortunately for these human calculators, pencils weren’t invented until 1795. Prior to the introduction of this advanced, graphite-based computing technology, mathematicians had to use quill and ink.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>In many French words, the sequence “os” has been replaced by a single, accented letter, <span class="math inline">\(\hat{o}\)</span>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dtkaplan\.github\.io\/MC2\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Differentiation/25-approximation.html" class="pagination-link" aria-label="Local approximations [DRAFT]">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Local approximations [DRAFT]</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Differentiation/Differentiation-projects.html" class="pagination-link" aria-label="Projects">
        <span class="nav-page-text">Projects</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dtkaplan/MC2/edit/main/Differentiation/26-taylor.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>