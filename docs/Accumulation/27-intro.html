<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>34&nbsp; Change &amp; accumulation – MOSAIC Calculus</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Accumulation/28-visualizing.html" rel="next">
<link href="../accumulation-part.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
</head><body class="nav-sidebar floating nav-fixed slimcontent"><span class="math inline" style="display: none;">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}
\newcommand{\pnorm}{\text{pnorm}}
\newcommand{\dnorm}{\text{dnorm}}
\let\origvec\vec
\let\origmathit\mathit
\let\orighat\hat
\let\origbar\bar
\newcommand{\vec}[1]{\overset{{\rule[-1pt]{0mm}{1mm}}\rightharpoonup}{\mathbf{#1}}}
\newcommand{\bar}[1]{\overset{{\rule[-1pt]{12pt}{.5mm}}}{\mathbf{#1}}}
\newcommand{\mathit}[1]{\underset{\leftharpoondown}{\overset{{\rightharpoonup}}{\large\mathbf #1}}}
\newcommand{\hat}[1]{\widehat{\ \mathbf#1\ }}
\newcommand{\len}[1]{{\|{\mathbf #1}\|}}
\newcommand{\tvec}[1]{\overset{\uparrow}{\mathbf #1}}
\newcommand{\tmat}[1]{\overset{\leftrightarrows}{\mathbf #1}}
\newcommand{\perpendicularto}[2]{#1\!\perp\!#2}
\newcommand{\modeledby}[2]{#1\!\sim\!#2}
\newcommand{\CC}[1]{\color{#648fff}{#1}}
\newcommand{\CE}[1]{\color{#785ef0}{#1}}
\newcommand{\CA}[1]{\color{#dc267f}{#1}}
\newcommand{\CB}[1]{\color{#fe6100}{#1}}
\newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
</span>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../mosaic-calc-style.css">




<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../www/Cover-1.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MOSAIC Calculus</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/dtkaplan/MC2/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../accumulation-part.html">BLOCK IV. Accumulation</a></li><li class="breadcrumb-item"><a href="../Accumulation/27-intro.html"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Change &amp; accumulation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../preliminaries-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PRELIMINARIES</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/01-quant-fun-space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Quantity, function, space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/02-notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/03-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Computing with R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/04-graphs-and-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visualizing functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/05-pattern-book-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pattern-book functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/06-describing-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Describing functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/07-data-and-data-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data and data graphics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../modeling-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK I. Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/01-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parameters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/02-assembling-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Assembling functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/03-functions-with-multiple-inputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Functions with multiple inputs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/04-fitting-by-eye.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fitting features</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/05-low-order-polynomials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Low-order polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/06-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Operations on functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/07-magnitudes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Magnitude</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/08-dimensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Dimensions and units</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/09-modeling-cycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Modeling cycle [DRAFT]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/Modeling-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiation-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK II. Differentiation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/16-continuous-change.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Continuous change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/17-rate-of-change.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Rate of change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/18-evanescent-h.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evanescent h</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/19-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Constructing derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/20-concavity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Concavity and curvature</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/21-cont-and-smooth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Continuity and smoothness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/22-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Derivatives of assembled functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/23-optim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/24-partial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Partial change and the gradient vector</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/25-approximation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Local approximations [DRAFT]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/26-taylor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/Differentiation-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../linear-combinations-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK III. Vectors and linear combinations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-Vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-linear-combinations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linear combinations of vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-projection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Projection &amp; residual</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-target-problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">The target problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-stat-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Statistical modeling and R<sup>2</sup></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Functions as vectors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../accumulation-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK IV. Accumulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/27-intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Change &amp; accumulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/28-visualizing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Totaling the little bits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/29-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Integration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/30-euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Integrals step-by-step</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/31-symbolic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Symbolic anti-differentiation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../dynamics-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK V. Dynamics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-diff-eq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Differential equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Finding a “solution”</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-flow-on-line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Flows on the line</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-flow-on-plane.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Flows on the plane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modeling dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-equilibria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Equilibrium and transient</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-eigen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Eigenvalues, eigenvectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-second-order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Force-balance equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../manifestations-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK VI. Manifestations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Operations on functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-splines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Data-driven functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Optimization and constraint</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Probability and evidence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-future-value.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Present and future value</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-mechanics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Mechanics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Symbolic-manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Symbolic manipulations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../R-mosaic-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setting up R/mosaic</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#accumulation" id="toc-accumulation" class="nav-link active" data-scroll-target="#accumulation"><span class="header-section-number">34.1</span> Accumulation</a></li>
  <li><a href="#notation-for-anti-differentiation" id="toc-notation-for-anti-differentiation" class="nav-link" data-scroll-target="#notation-for-anti-differentiation"><span class="header-section-number">34.2</span> Notation for anti-differentiation</a></li>
  <li><a href="#rmosaic-notation" id="toc-rmosaic-notation" class="nav-link" data-scroll-target="#rmosaic-notation"><span class="header-section-number">34.3</span> R/mosaic notation</a></li>
  <li><a href="#dimension-and-anti-differentiation" id="toc-dimension-and-anti-differentiation" class="nav-link" data-scroll-target="#dimension-and-anti-differentiation"><span class="header-section-number">34.4</span> Dimension and anti-differentiation</a></li>
  <li><a href="#sec-preliminary-terrors" id="toc-sec-preliminary-terrors" class="nav-link" data-scroll-target="#sec-preliminary-terrors"><span class="header-section-number">34.5</span> From <em>Calculus Made Easy</em></a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">34.6</span> Exercises</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dtkaplan/MC2/edit/main/Accumulation/27-intro.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../accumulation-part.html">BLOCK IV. Accumulation</a></li><li class="breadcrumb-item"><a href="../Accumulation/27-intro.html"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Change &amp; accumulation</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-change-accumulation" class="quarto-section-identifier"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Change &amp; accumulation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Every 10 years, starting in 1790, the US Census Bureau carries out a constitutionally mandated census: a count of the current population. The overall count as a function of year is shown in <a href="#fig-pop-graph" class="quarto-xref">Figure&nbsp;<span>34.1</span></a>. [<a href="https://en.wikipedia.org/wiki/Demographic_history_of_the_United_States">Source</a>]</p>
<p>In the 230 years spanned by the census data, the US population has grown 100-fold, from about 4 million in 1790 to about 330,000,000 in 2020.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-pop-graph" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pop-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="27-intro_files/figure-html/fig-pop-graph-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pop-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;34.1: US population since 1790. Left: linear axes. Right: semi-log axes
</figcaption>
</figure>
</div>
</div>
</div>
<p>It is tempting to look for simple patterns in such data. Perhaps the US population has been growing exponentially. A semi-log plot of the same data suggests that the growth is only very roughly exponential. A truly exponential process would present as a curve with a constant derivative, but the derivative of the function in the graph is decreasing over the centuries.</p>
<p>Insofar as the slope over the semi-log graph is informative, it amounts to this quantity: <span class="math display">\[\partial_t \ln(\text{pop}(t)) = \frac{\partial_t\, \text{pop}(t)}{\text{pop}}\]</span> This is the <em>per-capita</em> rate of growth, that is, the rate of change in the population divided by the population. Conventionally, this fraction is presented as a percentage: percentage growth in the population per year, as in <a href="#fig-pop-growth" class="quarto-xref">Figure&nbsp;<span>34.2</span></a>.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<pre data-cap-location="margin"><code>## Warning: Using the `size` aesthetic with geom_line was deprecated in ggplot2 3.4.0.
## ℹ Please use the `linewidth` aesthetic instead.</code></pre>
<div class="cell-output-display page-columns page-full">
<div id="fig-pop-growth" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-pop-growth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="27-intro_files/figure-html/fig-pop-growth-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-pop-growth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;34.2: Annual per capita growth rate of the US population (percent)
</figcaption>
</figure>
</div>
</div>
</div>
<p>The dots in the graph are a direct calculation from the census data. There is a lot of fluctuation, but an overall trend stands out: the population growth rate has been declining since the mid-to late 1800s. The deviations from the trend are telling and correspond to historical events. There is a relatively low growth rate seen from 1860 to 1870: that is the effect of the US Civil War. The Great depression is seen in the very low growth from 1930 to 1940. Baby Boom: look at the growth from 1950-1960. The bump from 1990 to 2000? Not coincidentally, the 1990 Immigration Act substantially increased the yearly rate of immigration.</p>
<p>If the trend in the growth rate continues, the US will reach zero net growth about 2070, then continue with negative growth. Of course, negative growth is just decline. A simple prediction from <a href="#fig-pop-growth" class="quarto-xref">Figure&nbsp;<span>34.2</span></a> is that the argmax of the US population—that is, the year that the growth rate reaches zero—will occur around 2070.</p>
<p>How large will the population be when it reaches its maximum?</p>
<p>In Block 2, we dealt with situations where we know the function <span class="math inline">\(f(t)\)</span> and want to find the rate of change <span class="math inline">\(\partial_t f(t)\)</span>. Here, we know the rate of change of the population and we need to figure out the population itself, in other words to figure out from a known <span class="math inline">\(\partial_t f(t)\)</span> what is the unknown function <span class="math inline">\(f(t)\)</span>.</p>
<p>The process of figuring out <span class="math inline">\(f(t) \longrightarrow \partial_t f(t)\)</span> is, of course, called <strong><em>differentiation</em></strong>. The opposite process, <span class="math inline">\(\partial_t f(t) \longrightarrow f(t)\)</span> is called <strong><em>anti-differentiation</em></strong>.</p>
<p>In this block we will explore the methods for calculating anti-derivatives and some of the settings in which anti-derivative problems arrive.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" data-latex="">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math in the World: Population growth
</div>
</div>
<div class="callout-body-container callout-body">
<p>The predictions from the accumulate-population-growth model are shown as a <span class="math inline">\(\color{magenta}{\text{magenta}}\)</span> line in <a href="#fig-pop-prediction-bad" class="quarto-xref">Figure&nbsp;<span>34.3</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pop-prediction-bad" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pop-prediction-bad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="27-intro_files/figure-html/fig-pop-prediction-bad-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pop-prediction-bad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;34.3: Predicted US population based on the historical linear decline in per-capita growth.
</figcaption>
</figure>
</div>
</div>
</div>
<p>According to the accumulation model, the population peaks in 2075 at 390 million. We will be back down to the present population level in about 100 years.</p>
<p>Professional demographers make much more sophisticated models using detailed data from many sources. The demographers at the US Census Bureau predict that the population will reach a maximum of 404 million in 2060, shown by the little blue dot in <a href="#fig-pop-prediction-bad" class="quarto-xref">Figure&nbsp;<span>34.3</span></a>. that is not too different from what we got by analyzing just the raw census numbers.</p>
</div>
</div>
<section id="accumulation" class="level2" data-number="34.1">
<h2 data-number="34.1" class="anchored" data-anchor-id="accumulation"><span class="header-section-number">34.1</span> Accumulation</h2>
<p>Imagine a simple setting: water flowing out of a tap into a basin or tank. The amount of water in the basin will be measured in a unit of volume, say liters. Measurement of the <em>flow</em> <span class="math inline">\(f(t)\)</span> of water from the tap into the tank has different units, say liters per second. If volume <span class="math inline">\(V(t)\)</span> is the volume of water in the tank as a function of time, <span class="math inline">\(f(t)\)</span> at any instant is <span class="math inline">\(f(t) = \partial_t V(t)\)</span>.</p>
<p>There is a relationship between the two functions <span class="math inline">\(f(t)\)</span> and <span class="math inline">\(V(t)\)</span>. With derivatives, we can give a good description of that relationship: <span class="math display">\[f(t) = \partial_t V(t)\]</span> This description will be informative if we have measured the volume of water in the basin as a function of time and want to deduce the rate of flow from the tap. Now suppose we have measured the flow <span class="math inline">\(f(t)\)</span> and want to figure out the volume. The volume at any instant is the past flow accumulated to that instant. As a matter of notation, we write this view of the relationship as <span class="math display">\[V(t) = \int f(t) dt,\]</span> which you can read as “volume is the accumulated flow.”</p>
<p>Other examples of accumulation and change:</p>
<ul>
<li>velocity is the rate of change of position <em>with respect to time</em>. Likewise, position is the accumulation of velocity <em>over time</em>.</li>
<li>force is the rate of energy <em>with respect to position</em>. Likewise energy is the accumulation of force <em>as position changes</em>.</li>
<li>deficit is the rate of change of debt with respect to time. Likewise, debt is the accumulation of deficit over time.</li>
</ul>
</section>
<section id="notation-for-anti-differentiation" class="level2" data-number="34.2">
<h2 data-number="34.2" class="anchored" data-anchor-id="notation-for-anti-differentiation"><span class="header-section-number">34.2</span> Notation for anti-differentiation</h2>
<p>For differentiation we are using the notation <span class="math inline">\(\partial_x\)</span> as in <span class="math inline">\(\partial_x f(x)\)</span>. Remember that the subscript on <span class="math inline">\(\partial\)</span> names the <strong><em>with-respect-to input</em></strong>. There are three pieces of information this notation:</p>
<ol type="1">
<li>The <span class="math inline">\(\color{magenta}{\partial}\)</span> symbol which identifies the operation as partial <strong><em>differentiation</em></strong>.</li>
<li>The name of the with-respect-to input <span class="math inline">\(\partial_{\color{magenta}{x}}\)</span> written as a subscript to <span class="math inline">\(\partial\)</span>.</li>
<li>The function to be differentiated, <span class="math inline">\(\partial_x \color{magenta}{f(x)}\)</span>.</li>
</ol>
<p>For <strong><em>anti-differentiation</em></strong>, our notation must also specify the three pieces of information. It might be tempting to use the same notation as differentiation but replace the <span class="math inline">\(\partial\)</span> symbol with something else, perhaps <span class="math inline">\(\eth\)</span> or <span class="math inline">\(\spadesuit\)</span> or <span class="math inline">\(\forall\)</span>, giving us something like <span class="math inline">\(\spadesuit_x f(x)\)</span>.</p>
<p>Convention has something different in store. The notation for anti-differentiation is <span class="math display">\[\large \int f(x) dx\]</span> 1. The <span class="math inline">\(\color{magenta}{\int}\)</span> is the marker for anti-differentiation. 2. The name of the with-respect-to input is contained in the “dx” at the end of the notation: <span class="math inline">\(\int f(x) d\color{magenta}{x}\)</span> 3. The function being anti-differentiated is in the middle <span class="math inline">\(\int \color{magenta}{f(x)} dx\)</span>.</p>
<p>For those starting out with anti-differentiation, the conventional notation can be confusing, especially the <span class="math inline">\(dx\)</span> part. It is easy confuse <span class="math inline">\(d\)</span> for a constant and <span class="math inline">\(x\)</span> for part of the function being anti-differentiated.</p>
<p>Think of the <span class="math inline">\(\int\)</span> and the <span class="math inline">\(dx\)</span> as <strong>brackets</strong> around the function. You need both brackets for correct notation, the <span class="math inline">\(\int\)</span> and the <span class="math inline">\(dx\)</span> together telling you what operation to perform.</p>
<p>Remember that just as <span class="math inline">\(\partial_x f(x)\)</span> is a function, so is <span class="math inline">\(\int f(x) dx\)</span>.</p>
</section>
<section id="rmosaic-notation" class="level2" data-number="34.3">
<h2 data-number="34.3" class="anchored" data-anchor-id="rmosaic-notation"><span class="header-section-number">34.3</span> R/mosaic notation</h2>
<p>Recall that the notation for differentiation in R/mosaic is <code>D(f(x) ~ x)</code>. The R/mosaic notation for anti-differentiation is very similar:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">D</span>(<span class="fu">f</span>(x) <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This has the same three pieces of information as <span class="math inline">\(\partial_x f(x)\)</span></p>
<ol type="1">
<li><code>D()</code> signifies differentiation whereas <code>antiD()</code> signifies anti-differentiation.</li>
<li><code>~ x</code> identifies the with-respect-to input.</li>
<li><code>f(x) ~</code> is the function on which the operation is to be performed.</li>
</ol>
<p>Remember that just as <code>D(f(x) ~ x)</code> creates a new function out of <code>f(x) ~ x</code>, so does <code>antiD(f(x) ~ x)</code>.</p>
</section>
<section id="dimension-and-anti-differentiation" class="level2" data-number="34.4">
<h2 data-number="34.4" class="anchored" data-anchor-id="dimension-and-anti-differentiation"><span class="header-section-number">34.4</span> Dimension and anti-differentiation</h2>
<p>This entire block will be about anti-differentiation, its properties and its uses. You already know that anti-differentiation (as the name suggests) is the inverse of differentiation. There is one consequence of this that is helpful to keep in mind as we move on to other chapters. This being calculus, the functions that we construct and operate upon have inputs that are quantities and outputs that are also quantities. Every quantity has a dimension, as discussed in Chapter 16. When you are working with any quantity, you should be sure that you know its dimension and its units.</p>
<p>The dimension of the input to a function does not by any means have to be the same as the dimension of the output. For instance, we have been using many functions where the input has dimension <strong>time</strong> and the output is position (dimension L) or velocity (dimension L/T) or acceleration (dimension L/T<span class="math inline">\(^2\)</span>).</p>
<p>Imagine working with some function <span class="math inline">\(f(y)\)</span> that is relevant to some modeling project of interest to you. Returning to the bracket notation that we used in Chapter 16, the dimension of the input quantity will be [<span class="math inline">\(y\)</span>]. The dimension of the output quantity is [<span class="math inline">\(f(y)\)</span>]. (Remember from 16 that [<span class="math inline">\(y\)</span>] means “the dimension of quantity <span class="math inline">\(y\)</span>” and that [<span class="math inline">\(f(y)\)</span>] means “the dimension of the <em>output</em> from <span class="math inline">\(f(y)\)</span>.”)</p>
<p>The function <span class="math inline">\(\partial_y f(y)\)</span> has the same input dimension <span class="math inline">\([y]\)</span> but the output will be <span class="math inline">\([f(y)] / [y]\)</span>. For example, suppose <span class="math inline">\(f(y)\)</span> is the mass of fuel in a rocket as a function of time <span class="math inline">\(y\)</span>. The output of <span class="math inline">\(f(y)\)</span> has dimension M. The input dimension <span class="math inline">\([y]\)</span> is T.</p>
<p>The output of the function <span class="math inline">\(\partial_y f(y)\)</span> has dimension <span class="math inline">\([f(y)] / [y]\)</span>, which in this case will be M / T. (Less abstractly, if the fuel mass is given in kg, and time is measured in seconds, then <span class="math inline">\(\partial_y f(y)\)</span> will have units of kg-per-second.)</p>
<p>How about the dimension of the anti-derivative <span class="math inline">\(F(y) = \int f(y) dy\)</span>? Since <span class="math inline">\(F(y)\)</span> is the anti-derivative of <span class="math inline">\(f(y)\)</span> (with respect to <span class="math inline">\(y\)</span>), we know that <span class="math inline">\(\partial_y F(y) = f(y)\)</span>. Taking the dimension of both sides <span class="math display">\[[\partial_y F(y)] = \frac{[F(y)]}{[y]} = \frac{[F(y)]}{\text{T}} = [f(y)] = \text{M}\]</span> Consequently, <span class="math inline">\([F(y)] = \text{M}\)</span>.</p>
<p>To summarize:</p>
<ul>
<li>The dimension of derivative <span class="math inline">\(\partial_y f(y)\)</span> will be <span class="math inline">\([f(y)] / [y]\)</span>.</li>
<li>The dimension of the anti-derivative <span class="math inline">\(\int f(y) dy\)</span> will be <span class="math inline">\([f(y)]\times [y]\)</span>.</li>
</ul>
<p>Or, more concisely:</p>
<blockquote class="blockquote">
<p>Differentiation is like division, anti-differentiation is like multiplication.</p>
</blockquote>
<p>Paying attention to the dimensions (and units!) of input and output can be a boon to the calculus student. Often students have some function <span class="math inline">\(f(y)\)</span> and they are wondering which of the several calculus operations they are supposed to do: differentiation, anti-differentiation, finding a maximum, finding an argmax or a zero. Start by figuring out the dimension of the quantity you want. From that, you can often figure out which operation is appropriate.</p>
<p>To illustrate, imagine that you have constructed <span class="math inline">\(f(y)\)</span> for your task and you know, say, <span class="math display">\[[f(y)] = \text{M       and} \  \ \ \ \ [y] = \text{T}\ .\]</span> Look things up in the following table:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Dimension of result</th>
<th>Calculus operation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>M / T</td>
<td>differentiate</td>
</tr>
<tr class="even">
<td>M T</td>
<td>anti-differentiate</td>
</tr>
<tr class="odd">
<td>M</td>
<td>find max or min</td>
</tr>
<tr class="even">
<td>T</td>
<td>find argmax/argmin or a function zero</td>
</tr>
<tr class="odd">
<td>M T<span class="math inline">\(^2\)</span></td>
<td>anti-differentiate twice in succession</td>
</tr>
<tr class="even">
<td>M / T<span class="math inline">\(^2\)</span></td>
<td>differentiate twice in succession</td>
</tr>
</tbody>
</table>
<p>For example, suppose the output of the accelerometer on your rocket has dimension L / T<span class="math inline">\(^2\)</span>. You are trying to figure out from the accelerometer reading what is your altitude. Altitude has dimension L. Look up in the table to see that you want to anti-differentiate acceleration twice in succession.</p>
</section>
<section id="sec-preliminary-terrors" class="level2" data-number="34.5">
<h2 data-number="34.5" class="anchored" data-anchor-id="sec-preliminary-terrors"><span class="header-section-number">34.5</span> From <em>Calculus Made Easy</em></h2>
<p><a href="https://en.wikipedia.org/wiki/Calculus_Made_Easy"><em>Calculus Made Easy</em></a>, by Silvanus P. Thompson, is a classic, concise, and elegant textbook from 1910. It takes a common-sense approach, sometimes lampooning the traditional approach to teaching calculus.</p>
<blockquote class="blockquote">
<p><em>Some calculus-tricks are quite easy. Some are enormously difficult. The fools who write the textbooks of advanced mathematics—and they are mostly clever fools—seldom take the trouble to show you how easy the easy calculations are. On the contrary, they seem to desire to impress you with their tremendous cleverness by going about it in the most difficult way.</em> — From the preface</p>
</blockquote>
<p>Thompson’s first chapter starts with the notation of accumulation, which he calls “the preliminary terror.”</p>
<div class="madeeasy">
<p>The preliminary terror … can be abolished once for all by simply stating what is the meaning—in common-sense terms—of the two principal symbols that are used in calculating.</p>
<p>These dreadful symbols are:</p>
<ol type="1">
<li><span class="math inline">\(\Large\  d\)</span> which merely means “a little bit of.”</li>
</ol>
<p>Thus <span class="math inline">\(dx\)</span> means a little bit of <span class="math inline">\(x\)</span>; or <span class="math inline">\(du\)</span> means a little bit of <span class="math inline">\(u\)</span>. Ordinary mathematicians think it more polite to say “an element of,” instead of “a little bit of.” Just as you please. But you will find that these little bits (or elements) may be considered to be indefinitely small.</p>
<ol start="2" type="1">
<li><span class="math inline">\(\ \ \large\int\)</span> which is merely a long <span class="math inline">\(S\)</span>, and may be called (if you like) “the sum of.”</li>
</ol>
<p>Thus <span class="math inline">\(\ \int dx\)</span> means the sum of all the little bits of <span class="math inline">\(x\)</span>; or <span class="math inline">\(\ \int dt\)</span> means the sum of all the little bits of <span class="math inline">\(t\)</span>. Ordinary mathematicians call this symbol “the integral of.” Now any fool can see that if <span class="math inline">\(x\)</span> is considered as made up of a lot of little bits, each of which is called <span class="math inline">\(dx\)</span>, if you add them all up together you get the sum of all the <span class="math inline">\(dx\)</span>’s, (which is the same thing as the whole of <span class="math inline">\(x\)</span>). The word “integral” simply means “the whole.” If you think of the duration of time for one hour, you may (if you like) think of it as cut up into <span class="math inline">\(3600\)</span> little bits called seconds. The whole of the <span class="math inline">\(3600\)</span> little bits added up together make one hour.</p>
<p>When you see an expression that begins with this terrifying symbol, you will henceforth know that it is put there merely to give you instructions that you are now to perform the operation (if you can) of totaling up all the little bits that are indicated by the symbols that follow.</p>
</div>
<hr>
<p>The next chapter shows what it means to “total up all the little bits” of a function.</p>
</section>
<section id="exercises" class="level2" data-number="34.6">
<h2 data-number="34.6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">34.6</span> Exercises</h2>
<section id="exercise-34.01" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-34.01">Exercise 34.01</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  What is the name of the with-respect-to input in $\int g(y) dy$? </code></pre>
<p>y dy x t</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part B**  What is the name of the with-respect-to input in $\int g(t) dy$ </code></pre>
<p>y dy x t</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part C**  What is the name of the with-respect-to input in $\int g(x, t) dt$ </code></pre>
<p>y dt x t</p>
</div>
</div>
</section>
<section id="exercise-34.02" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-34.02">Exercise 34.02</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  Which of the following functions is $\int \left[a + bx \right] dx$? (Hint: Differentiate each of them until you find the one that matches $a + bx$.) </code></pre>
<ol type="a">
<li><span class="math inline">\(ax + \frac{1}{2}b x^2 + C\)</span></li>
<li><span class="math inline">\(ax + 2 b x^2 + C\)</span></li>
<li><span class="math inline">\(a + b x^2 + C\)</span></li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part B**  Which of the following functions is $\int e^{-kx} dt$? </code></pre>
<p><span class="math inline">\(-e^{-kx}\,/\,k\)</span> <span class="math inline">\(- k e^{-k x}\)</span> <span class="math inline">\(e^{-kx}\,/\,k\)</span></p>
</div>
</div>
</section>
<section id="exercise-34.03" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-34.03">Exercise 34.03</h4>
<p>Every function has an anti-derivative. But there are many functions, for example <span class="math inline">\(\dnorm()\)</span> where there is no formula for the anti-derivative. Even so, the R/mosaic <code>antiD()</code> operator will figure out what is the anti-derivative.</p>
<p>For each of the following functions, use <code>makeFun()</code> to implement the function as <code>f()</code>. Then use <code>antiD()</code> to construct the anti-derivative of <code>f()</code> and give this the name <code>F()</code>. Finally, use <code>D()</code> to compute the derivative of <code>F()</code>. For instance:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(x<span class="sc">*</span><span class="fu">dnorm</span>(x) <span class="sc">~</span> x)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">antiD</span>(<span class="fu">f</span>(x) <span class="sc">~</span> x)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dF <span class="ot">&lt;-</span> <span class="fu">D</span>(<span class="fu">F</span>(x) <span class="sc">~</span> x)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">f</span>(x) <span class="sc">~</span> x, <span class="fu">bounds</span>(<span class="at">x=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">dF</span>(x) <span class="sc">~</span> x, <span class="at">color=</span><span class="st">"blue"</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="27-intro_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  For the function $f(x) \equiv \pnorm(x^2)$, what is $F(5)$? (Pick the closest answer.) </code></pre>
<p>4 4.5 5 5.5 6 6.5</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part B**  For the function $f(x) \equiv \sin(x) \ln(x^2)$, what is $F(5)$? (Pick the closest answer.) </code></pre>
<p>-4 -3.5 -3 -2.5 -2</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part C**  For the function $f(x) \equiv x^2 \pnorm(x)$, what is $F(5)$? (Pick the closest answer.) </code></pre>
<p>35 37 39 41 43</p>
</div>
</div>
</section>
<section id="exercise-34.04" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-34.04">Exercise 34.04</h4>
<p>In the population prediction model at the start of the chapter we want to find a function <span class="math inline">\(P(y)\)</span> that gives the population as a function of year <span class="math inline">\(y\)</span>. From the data, we plotted out <span class="math inline">\(\ln\left[P(y)\right]\)</span> and found a fairly smooth curve that was upward sloping and concave down. Next, we made a plot of the derivative with respect to year of that upward-sloping, concave-down curve and found the derivative to be well approximated by a straight-line function with a negative slope <span class="math inline">\(a - b y\)</span>. In other words, we found <span class="math display">\[\partial_y \ln(P(y)) = a - b\,y\]</span> We want to figure out <span class="math inline">\(P(y)\)</span> from this relationship.</p>
<p><strong>Step 1</strong>: Anti-differentiate the functions on both sides of the equation. Anti-differentiation has the effect of cancelling out the <span class="math inline">\(\partial_y\)</span> from the left side of the equation. Anti-differentiating the right side means calculating <span class="math inline">\(\int \left[a - b\, y\right]\ dy\)</span>.</p>
<p>Task 1: Confirm that <span class="math inline">\(\int \left[a - b\,y\right]dy = a y - \frac{1}{2} b y^2 + C\)</span>.</p>
<p><strong>Step 2</strong>: From Step 1 we have translated the relationship between population and year into this form:</p>
<p><span class="math display">\[\ln(P(y)) = a y - \frac{1}{2} b y^2 + C\]</span></p>
<p>Task 2: Exponentiate both sides of the newly framed relationship to get <span class="math display">\[P(y) = \exp\left(a y - \frac{1}{2} b y^2 + C\right) = e^{ay -b y^2} e^C = A e^{ay -b y^2}\]</span> where <span class="math inline">\(A = e^C\)</span>.</p>
<p><strong>Step 3</strong>: Let’s declare that <span class="math inline">\(y=0\)</span> means year 2020.</p>
<p>Task 3: Find the census estimate of the population in 2020 and use that information to estimate the parameter <span class="math inline">\(A\)</span> in <span class="math inline">\(P(y) = A e^{ay-b y^2}\)</span>.</p>
<p><strong>Step 4</strong>: The <em>per-capita</em> growth rate is <span class="math display">\[G(y) \equiv \frac{\partial_y P(y)}{P(y)} \approx \frac{\partial_y A e^{a y - b y^2}}{A e^{ay - b y^2}} = a - 2 b y\]</span> The data suggest that the current growth rate is about 1% per year, so <span class="math inline">\(G(0) = a =  \approx 0.01\)</span>. We also know that the growth rate will be around zero in 2070 years time. Year 2070 corresponds to <span class="math inline">\(y=50\)</span>. Consequently, <span class="math inline">\(G(50) = 0.01 - 2\cdot 50\cdot b\approx 0\)</span>. You can easily solve this for <span class="math inline">\(b\)</span>.</p>
<p>Task 4: You now have numerical estimates for the parameters <span class="math inline">\(A\)</span>, <span class="math inline">\(a\)</span>, and <span class="math inline">\(b\)</span> in the function <span class="math inline">\(P(y)\)</span>. Using these parameters, plot out <span class="math inline">\(P(y)\)</span> for the next 200 years. According to the prediction, what will be the population in year 2220?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill in your estimates for A, a, and b.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(A<span class="sc">*</span><span class="fu">exp</span>(a<span class="sc">*</span>y <span class="sc">-</span> b<span class="sc">*</span>(y<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">~</span> y, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">a =</span> ____, <span class="at">b =</span> ____, <span class="at">A =</span> ____)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># y = 200 is year 2220.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">P</span>(y) <span class="sc">~</span> y, <span class="fu">bounds</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">200</span>)))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># At y=200, the estimate is 50 M</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercise-34.05" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-34.05">Exercise 34.05</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="27-intro_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>The graph shows a function <span class="math inline">\(f(x)\)</span>. Like all functions, it has an anti-derivative. Here are several functions, <span class="math inline">\(F_1(x)\)</span> through <span class="math inline">\(F_4(x)\)</span>.</p>
<p>One and only one is the anti-derivative of the function shown in the graph. Which one?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>F1 <span class="ot">&lt;-</span> <span class="fu">doodle_fun</span>(<span class="sc">~</span> x, <span class="at">seed =</span> <span class="dv">782</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>F2 <span class="ot">&lt;-</span> <span class="fu">doodle_fun</span>(<span class="sc">~</span> x, <span class="at">seed =</span> <span class="dv">934</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>F3 <span class="ot">&lt;-</span> <span class="fu">doodle_fun</span>(<span class="sc">~</span> x, <span class="at">seed =</span> <span class="dv">297</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>F4 <span class="ot">&lt;-</span> <span class="fu">doodle_fun</span>(<span class="sc">~</span> x, <span class="at">seed =</span> <span class="dv">892</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>NOTE: <code>doodle_fun()</code> is a program that generates functions, a different one for each <code>seed</code>. It has been used here to generate <code>F1()</code> through <code>F4()</code> for you to use. Once you run those four lines in your sandbox, you can use <code>slice_plot()</code> in the usual way to plot out any of the four functions over the domain <span class="math inline">\(-5 \leq x \leq 5\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  Confirming graphically that a candidate $F_i(x)$ is indeed the anti-derivative of $f(x)$ is hard because the two functions can have very different shapes. But there is a very simple operation you can apply to $F_i(x)$ to make the comparison trivial. What is this operation? </code></pre>
<ol type="a">
<li>anti-differentiate <span class="math inline">\(F_i(x)\)</span></li>
<li>differentiate <span class="math inline">\(F_i(x)\)</span></li>
<li>compose <span class="math inline">\(f(x)\)</span> with itself</li>
<li>multiply <span class="math inline">\(F_i(x)\)</span> times $f(x)</li>
</ol>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part B**  Which one of the functions is an anti-derivative of the function graphed above? (Hint: See the next problem.) </code></pre>
<p><code>F1()</code> <code>F2()</code> <code>F3()</code> <code>F4()</code></p>
</div>
</div>
<p>Problem with Accumulation Exercises/frog-choose-coat.Rmd</p>
</section>
<section id="exercise-34.07" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="exercise-34.07">Exercise 34.07</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part A**  What is the anti-derivative of Force with respect to distance? </code></pre>
<p>Acceleration Work/Energy Momentum Power</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<pre><code>**Part B**  What is the anti-derivative of Velocity with respect to time? </code></pre>
<p>Momentum Displacement Power Acceleration</p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dtkaplan\.github\.io\/MC2\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../accumulation-part.html" class="pagination-link" aria-label="BLOCK IV. Accumulation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">BLOCK IV. Accumulation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Accumulation/28-visualizing.html" class="pagination-link" aria-label="Totaling the little bits">
        <span class="nav-page-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Totaling the little bits</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dtkaplan/MC2/edit/main/Accumulation/27-intro.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>