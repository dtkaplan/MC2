<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>40&nbsp; Differential equations – MOSAIC Calculus</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Dynamics/B6-solution.html" rel="next">
<link href="../dynamics-part.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
</head><body class="nav-sidebar floating nav-fixed slimcontent"><span class="math inline" style="display: none;">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}
\newcommand{\pnorm}{\text{pnorm}}
\newcommand{\dnorm}{\text{dnorm}}
\let\origvec\vec
\let\origmathit\mathit
\let\orighat\hat
\let\origbar\bar
\newcommand{\vec}[1]{\overset{{\rule[-1pt]{0mm}{1mm}}\rightharpoonup}{\mathbf{#1}}}
\newcommand{\bar}[1]{\overset{{\rule[-1pt]{12pt}{.5mm}}}{\mathbf{#1}}}
\newcommand{\mathit}[1]{\underset{\leftharpoondown}{\overset{{\rightharpoonup}}{\large\mathbf #1}}}
\newcommand{\hat}[1]{\widehat{\ \mathbf#1\ }}
\newcommand{\len}[1]{{\|{\mathbf #1}\|}}
\newcommand{\tvec}[1]{\overset{\uparrow}{\mathbf #1}}
\newcommand{\tmat}[1]{\overset{\leftrightarrows}{\mathbf #1}}
\newcommand{\perpendicularto}[2]{#1\!\perp\!#2}
\newcommand{\modeledby}[2]{#1\!\sim\!#2}
\newcommand{\CC}[1]{\color{#648fff}{#1}}
\newcommand{\CE}[1]{\color{#785ef0}{#1}}
\newcommand{\CA}[1]{\color{#dc267f}{#1}}
\newcommand{\CB}[1]{\color{#fe6100}{#1}}
\newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
</span>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../mosaic-calc-style.css">




<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../www/Cover-1.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MOSAIC Calculus</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/dtkaplan/MC2/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../dynamics-part.html">BLOCK V. Dynamics</a></li><li class="breadcrumb-item"><a href="../Dynamics/B6-diff-eq.html"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Differential equations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../preliminaries-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PRELIMINARIES</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/01-quant-fun-space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Quantity, function, space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/02-notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/03-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Computing with R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/04-graphs-and-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visualizing functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/05-pattern-book-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pattern-book functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/06-describing-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Describing functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Preliminaries/07-data-functions-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data, functions, graphics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../modeling-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK I. Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/08-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parameters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/09-assembling-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Assembling functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/10-functions-with-multiple-inputs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Functions with multiple inputs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/11-fitting-features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fitting features</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/12-low-order-polynomials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Low-order polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/13-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Operations on functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/14-magnitudes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Magnitude</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/15-dimensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Dimensions and units</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/16-modeling-scientific-method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Modeling and the scientific method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Modeling/Modeling-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiation-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK II. Differentiation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/17-continuous-change.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Continuous change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/18-rate-of-change.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Rate of change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/19-evanescent-h.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evanescent h</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/20-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Constructing derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/21-concavity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Concavity and curvature</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/22-cont-and-smooth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Continuity and smoothness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/23-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Derivatives of assembled functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/24-optim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/25-partial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Partial change and the gradient vector</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/26-approximation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Local approximations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/27-taylor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Differentiation/Differentiation-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Differentiation projects</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../linear-combinations-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK III. Vectors and linear combinations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-Vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-linear-combinations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Linear combinations of vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-projection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Projection &amp; residual</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-target-problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">The target problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Linear-combinations/B5-stat-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Statistical modeling and R<sup>2</sup></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../accumulation-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK IV. Accumulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/33-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Change &amp; accumulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/34-visualizing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Totaling the little bits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/35-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Integration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/36-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Functions as vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/37-euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Integrals step-by-step</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Accumulation/38-symbolic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Symbolic anti-differentiation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../dynamics-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK V. Dynamics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-diff-eq.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Differential equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Finding a “solution”</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-flow-on-line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Flows on the line</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-flow-on-plane.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Flows on the plane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Modeling dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-equilibria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Equilibrium and transient</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-eigen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Eigenvalues, eigenvectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dynamics/B6-second-order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Force-balance equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../manifestations-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLOCK VI. Manifestations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Operations on functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-splines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Data-driven functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Optimization and constraint</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Probability and evidence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-future-value.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Present and future value</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Manifestations/B4-mechanics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Mechanics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#dynamical-systems" id="toc-dynamical-systems" class="nav-link active" data-scroll-target="#dynamical-systems"><span class="header-section-number">40.1</span> Dynamical systems</a></li>
  <li><a href="#state" id="toc-state" class="nav-link" data-scroll-target="#state"><span class="header-section-number">40.2</span> State</a></li>
  <li><a href="#state-space" id="toc-state-space" class="nav-link" data-scroll-target="#state-space"><span class="header-section-number">40.3</span> State space</a></li>
  <li><a href="#dynamics" id="toc-dynamics" class="nav-link" data-scroll-target="#dynamics"><span class="header-section-number">40.4</span> Dynamics</a></li>
  <li><a href="#state-space-and-flow-field" id="toc-state-space-and-flow-field" class="nav-link" data-scroll-target="#state-space-and-flow-field"><span class="header-section-number">40.5</span> State space and flow field</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dtkaplan/MC2/edit/main/Dynamics/B6-diff-eq.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../dynamics-part.html">BLOCK V. Dynamics</a></li><li class="breadcrumb-item"><a href="../Dynamics/B6-diff-eq.html"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Differential equations</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-chap-diff-eq-intro" class="quarto-section-identifier"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Differential equations</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="dynamical-systems" class="level2" data-number="40.1">
<h2 data-number="40.1" class="anchored" data-anchor-id="dynamical-systems"><span class="header-section-number">40.1</span> Dynamical systems</h2>
<p>In this Block, we take on what an important application of derivatives: the representation of <strong><em>dynamical systems</em></strong>.</p>
<p>“Dynamical systems” (but not under that name) were developed initially in the 1600s to relate planetary motion to the force of gravity. Nowadays, they are used to describe all sorts of physical systems from oscillations in electrical circuits to the ecology of interacting species to the spread of contagious disease.</p>
<p>As examples of dynamical systems, consider a ball thrown thrown through the air or a rocket being launched to deploy a satellite. At each instant of time, a ball has a position—a point in <span class="math inline">\(x,y,z\)</span> space—and a velocity <span class="math inline">\(\partial_t x\)</span>, <span class="math inline">\(\partial_t y\)</span>, and <span class="math inline">\(\partial_t z\)</span>. These six quantities, and perhaps others like spin, constitute the <strong><em>instantaneous state</em></strong> of the ball. Rockets have additional components of state, for example the mass of the fuel remaining.</p>
<p>The “dynamical” in “dynamical systems” refers to the <strong><em>change in state</em></strong>. For the ball, the state changes under the influence of mechanisms such as gravity and air resistance. The mathematical representation of a dynamical system codifies how the state changes <em>as a function of the instantaneous state</em>. For example, if the instantaneous state is a single quantity called <span class="math inline">\(x\)</span>, the instantaneous change in state is the derivative of that quantity: <span class="math inline">\(\partial_t x\)</span>.</p>
<p>To say that <span class="math inline">\(x\)</span> changes in time is to say that <span class="math inline">\(x\)</span> is a <strong><em>function of time</em></strong>: <span class="math inline">\(x(t)\)</span>. When we write <span class="math inline">\(x\)</span>, we mean <span class="math inline">\(x()\)</span> evaluated at an instant. When we write <span class="math inline">\(\partial_t x\)</span>, we mean “the derivative of <span class="math inline">\(x(t)\)</span> with respect to time” evaluated at the same instant as for <span class="math inline">\(x\)</span>.</p>
<p>The dynamical system describing the motion of <span class="math inline">\(x\)</span> is written in the form of a <strong><em>differential equation</em></strong>, like this:</p>
<p><span class="math display">\[\partial_t x = f(x)\ .\]</span> Notice that the function <span class="math inline">\(f()\)</span> is directly a function of <span class="math inline">\(x\)</span>, not <span class="math inline">\(t\)</span>. This is very different from the situation we studied in Block 3, where we might have written <span class="math inline">\(\partial_t y = \cos\left(\frac{2\pi}{P} t\right)\)</span> and assigned you the challenge of finding the function <span class="math inline">\(y(t)\)</span> by anti-differentiation. (The answer to the anti-differentiation problem, of course, is <span class="math inline">\(y(t) = \frac{P}{2\pi}\sin\left(\frac{2\pi}{P} t\right) + C\)</span>.)</p>
<div class="takenote">
<p>It is <strong>essential</strong> that you train yourself to distinguish two very different statements</p>
<ol type="i">
<li>anti-differentiation problems like <span class="math inline">\(\partial_{\color{blue}{t}} y = g(\color{blue}{t})\)</span>, which has <span class="math inline">\(t\)</span> as <strong>both</strong> the with-respect-to variable and as the argument to the function <span class="math inline">\(g()\)</span>.</li>
</ol>
<p>and</p>
<ol start="2" type="i">
<li>dynamical systems like <span class="math display">\[\partial_{\color{blue}{t}} \color{magenta}{y} = g(\color{magenta}{y})\ .\]</span></li>
</ol>
<p>This is one place where Leibniz’s notation for derivatives can be useful: <span class="math display">\[\underbrace{\frac{d\color{magenta}{y}}{d\color{blue}{t}} = g(\color{blue}{t})}_{\text{as in antidifferentiation}}\ \ \ \text{versus}\ \ \ \underbrace{\frac{d\color{magenta}{y}}{d\color{blue}{t}} = g(\color{magenta}{y})}_{\text{dynamical system}}\]</span></p>
</div>
<p>Dynamical systems with multiple state quantities are written mathematically as sets of differential equations, for instance: <span class="math display">\[\partial_t y = g(y, z)\\
\partial_t z = h(y, z)\]</span> We typically use the word <strong><em>system</em></strong> rather than “set,” so a dynamical system is represented by a <strong><em>system of differential equations</em></strong>.</p>
<div class="example">
<p><span class="math inline">\(\ \)</span></p>
<p>Let’s illustrate the idea of a dynamical system with a children’s game: “Chutes and Ladders”. Since hardly any children have studied calculus, the game isn’t presented as differential equations, but as a simple board and the rules for the movement along the board.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-chutes-and-ladders" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chutes-and-ladders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="www/Chutes-and-ladders.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chutes-and-ladders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;40.1: The game of <em>Chutes and Ladders</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>A player’s state in this game is shown by the position of a token, but we will define the state to be the number of the square that the player’s token is on. In Chutes and Ladders the state is one of the integers from 1 to 100. In contrast, the dynamical systems that we will study with calculus have a state that is a point on the number line, or in the coordinate plane, or higher-dimensional space. Our calculus dynamical system describe the change of state using derivatives with respect to time, whereas in chutes and ladders the the state jumps from one value to the next value.</p>
<p>The game board displays not only the set of possible states but also the rule for <del>changing state</del> jumping from one state to another.</p>
<p>In the real game, players roll a die to determine how many steps to take to the next state. But we will play a simpler game: Just move one step forward on each turn, except … from place to place there are ladders that connect two squares. When the state reaches a square holding the foot of a ladder, the state is swept up to the higher-numbered square at the top of the ladder. Similarly, there are chutes. These work much like the ladders but carry the state from a higher-numbered square to a lower-numbered square.</p>
<p>The small drawings on the board are not part of the action of the game. Rather, they represent the idea that good deeds lead the player to progress, while wrong-doing produces regression. Thus, the productive gardener in square 1 is rewarded by being moved upward to the harvest in square 38. In square 64 a brat is pulling on his sister’s braids. This misdeed results in punishment: he is moved back to square 60.</p>
<p>Our dice-free version of Chutes and Ladders is an example of a <strong><em>discrete-time, discrete-state dynamical system</em></strong>. Since there is no randomness involved, the movement of the state is <strong><em>deterministic</em></strong>. (With dice, the movement would be <strong><em>stochastic</em></strong>.)</p>
<p>The differential equations of a dynamical system correspond to a <strong><em>continuous-time, continuous-space system</em></strong>. This continuity is the reason we use derivatives to describe the motion of the state. The movement in the systems we will explore is also deterministic. (In <a href="#sec-forcing" class="quarto-xref"><span class="quarto-unresolved-ref">sec-forcing</span></a> we will encounter briefly some instances of stochastic systems.)</p>
</div>
</section>
<section id="state" class="level2" data-number="40.2">
<h2 data-number="40.2" class="anchored" data-anchor-id="state"><span class="header-section-number">40.2</span> State</h2>
<p>The mathematical language of differential equations and dynamical systems is able to describe a stunning range of systems, for example:</p>
<ul>
<li>physics
<ol type="i">
<li>swing of a pendulum</li>
<li>bobbing of a mass hanging from a spring.</li>
<li>a rocket shooting up from the launch pad</li>
</ol></li>
<li>commerce
<ol type="i">
<li>investment growth</li>
<li>growth in equity in a house as a mortgage is paid up. (“Equity” is the amount of the value of the house that belongs to you.)</li>
</ol></li>
<li>biology
<ol type="i">
<li>growth of animal populations, including predator and prey.</li>
<li>spread of an infectious disease</li>
<li>growth of an organism or a crop.</li>
</ol></li>
</ul>
<p>All these systems involve a <strong><em>state</em></strong> that describes the configuration of the system at a given instant in time. For the growth of a crop, the state would be, say, the amount of biomass per unit area. For the spread of infectious disease, the state would be the fraction of people who are infectious and the fraction who are susceptible to infection. “State” in this sense is used in the sense of “the state of affairs,” or “his mental state,” or “the state of their finances.”</p>
<p>Since we are interested in how the state changes over time, sometimes we refer to it as the <strong><em>dynamical state</em></strong>.</p>
<p>One of the things you learn when you study a field such as physics or epidemiology or engineering is what constitutes a useful description of the dynamical state for different situations. In the crop and infectious disease examples above, the state mentioned is a strong simplification of reality: a model. Often, the <strong><em>modeling cycle</em></strong> leads the modeler to include more components to the state. For instance, some models of crop growth include the density of crop-eating insects. For infectious disease, a model might include the fraction of people who are incubating the disease but not yet contagious.</p>
<p>Consider the relatively simple physical system of a pendulum, swinging back and forth under the influence of gravity. In physics, you learn the essential <em>dynamical</em> elements of the pendulum system: the current angle the pendulum makes to the vertical, and the rate at which that angle changes. There are also <em>fixed</em> elements of the system, for instance the length of the pendulum’s rod and the local gravitational acceleration. Although such fixed characteristics may be important in describing the system, they are not elements of the <em>dynamical</em> state. Instead, they might appear as parameters in the functions on the right-hand side of the differential equations.</p>
<p>To be complete, the dynamical state of a system has to include all those changing aspects of the system that allow you to calculate from the state at this instant what the state will be at the next instant. For example, the angle of the pendulum at an instant tells you a lot about what the angle will be at the next instant, but not everything. You also need to know which way the pendulum is swinging and how fast.</p>
<p>Figuring out what constitutes the dynamical state requires knowledge of the mechanics of the system, e.g.&nbsp;the action of gravity, the constraint imposed by the pivot of the pendulum. You get that knowledge by studying the relevant field: electrical engineering, economics, epidemiology, etc. You also learn what aspects of the system are fixed or change slowly enough that they can be considered fixed. (Sometimes you find out that something your intuition tells you is important to the dynamics is, in fact, not. An example is the <em>mass</em> of the pendulum.)</p>
</section>
<section id="state-space" class="level2 page-columns page-full" data-number="40.3">
<h2 data-number="40.3" class="anchored" data-anchor-id="state-space"><span class="header-section-number">40.3</span> State space</h2>
<p>The state of a dynamical system tells you the configuration of the system at any instant in time. It is appropriate to think about the instantaneous state as a single point in a <strong><em>state space</em></strong>, a coordinate system with an axis for each component of state. As the system configuration changes with time—say, the pendulum loses velocity as it swings to the left—the instantaneous state moves along a <strong><em>path</em></strong> in the state space. Such a path is called a <strong><em>trajectory</em></strong> of the dynamical system.</p>
<p>In this book, we will work almost exclusively with systems that have a one- or two-dimensional state. Consequently, the state space will be either the number line or the coordinate plane. The methods you learn will be broadly applicable to systems with higher-dimensional state.</p>
<p>For the <strong><em>deterministic</em></strong> dynamical systems we will be working with, a basic principle is that <strong><em>a trajectory can never cross itself</em></strong>. This can be demonstrated by contradiction. Suppose a trajectory did cross itself. This would mean that the motion from the crossing point couple possibly go in either of two directions; the state might follow one branch of the cross or the other. Such a system would not be deterministic. Determinism implies that from each point in state space the flow goes only in one direction.</p>
<p>The <strong><em>dimension of the state space</em></strong> is the same as the number of components of the state; one axis of state space for every component of the state. has important implications for the type of motion that can exist.</p>
<ol type="i">
<li>If the state space is one-dimensional, the state as a function of time must be <strong><em>monotonic</em></strong>. Otherwise, the trajectory would cross itself, which is not permitted.</li>
<li>A state space that is two- or higher-dimensional can support motion that <strong><em>oscillates</em></strong> back and forth. Such a trajectory does not cross itself, instead it goes round and round in a spiral or a closed loop.</li>
</ol>
<p>For many decades, it was assumed that all dynamical systems produce either monotonic behavior or spiral or loop behavior. In the 1960s, scientists working on a highly simplified model of the atmosphere discovered numerically that there is a third type of behavior, the irregular and practically unpredictable behavior called <strong><em>chaos</em></strong>. To display chaos, the state space of the system must have at least three elements.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>That calculus is the language of change can be seen in the words used in this section. For instance, <em>instantaneous</em>, <em>continuous</em>, and <em>monotonic</em> are all words introduced in Block 1 of this book.</p>
</div></div><div class="callout callout-style-default callout-note no-icon callout-titled" data-latex="">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math in the World: The state of COVID
</div>
</div>
<div class="callout-body-container callout-body">
<p>What does it take to describe the dynamical state of an epidemic?</p>
<p>News reports of the COVID pandemic usually focus on the number of new cases each day and the fraction of the population that has been vaccinated. But this is not adequate, even for a simple description of the dynamics.</p>
<p>From a history of new-case counts over time (e.g. <a href="#fig-NYT-covid-history" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-NYT-covid-history</span></a>) you can see that the number of new cases waxes and wanes. Knowing that the number of cases today is, say, 100 thousand does not tell you what the number of cases <em>will be</em> in two weeks: 100 thousand is encountered both on the way up and on the way down.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<p>![COVID-19 new-case counts in the US over the first two years of the pandemic. <a href="https://www.nytimes.com/interactive/2021/us/covid-cases.html">Source: [<em>New York Times</em>]</a>]](www/NYT-covid-report.png){#fig-NYT-covid-history fig-align=‘center’ width=90%}</p>
</div>
</div>
</div>
</div>
</section>
<section id="dynamics" class="level2" data-number="40.4">
<h2 data-number="40.4" class="anchored" data-anchor-id="dynamics"><span class="header-section-number">40.4</span> Dynamics</h2>
<p>The <strong><em>dynamics</em></strong> of a system is a description of how the individual components of the <em>state</em> change as a <em>function of the entire set of components of the state.</em></p>
<p>At any instant in time, the state is a set of quantities. We will use <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> for the purpose of illustration, although most of our work in this introduction will be with systems that have just one or two state variables.</p>
<p>The differential equations describing the <span class="math inline">\(x, y, z\)</span> system have a particular form:</p>
<p><span class="math display">\[\partial_t x(t) = f(x(t), y(t), z(t))\ \, \\
\partial_t y(t) = g(x(t), y(t), z(t))\ \, \\
\partial_t z(t) = h(x(t), y(t), z(t))\ .\]</span></p>
<p>The way these equations are written is practically impossible to read: the expression <span class="math inline">\((t)\)</span> is repeated 12 times! It takes concentration to look beyond the <span class="math inline">\((t)\)</span> to see the overall structure of the equations. to avoid this problem of not seeing the forest for the <span class="math inline">\((t)\)</span>s, the convention is to omit the <span class="math inline">\((t)\)</span>: <span class="math display">\[\partial_t x = f(x, y, z)\\
\partial_t y = g(x, y, z)\\
\partial_t z = h(x, y, z)\]</span> This leaves it to the reader to remember that <span class="math inline">\(x\)</span> is really <span class="math inline">\(x(t)\)</span> and so on.</p>
<p>This more concise way of writing the differential equations makes it easier to describe how to interpret the equations. Formally, <span class="math inline">\(\partial_t x\)</span> is a function, the derivative of the function <span class="math inline">\(x(t)\)</span> with respect to time. But try to put this highly literal interpretation on a back burner. Think of the expression <span class="math inline">\(\partial_t x =\)</span> as meaning, “the way the <span class="math inline">\(x\)</span>-component of state changes in time is described by ….” We need three differential equations because there are three components of state in the <span class="math inline">\(x,y,z\)</span> system, and we need to describe for each component the way that component changes.</p>
<p>On the right side of each equation is a function that takes the state quantities as inputs. Each individual equation can be interpreted as completing the elliptical sentence (that is, ending in “…”) in the previous paragraph, so that the whole equation reads like, “The way the <span class="math inline">\(x\)</span>-component of state changes at any instant in time is specified by the function <span class="math inline">\(h()\)</span> evaluated at the instantaneous state.” These functions are called <strong><em>dynamical functions</em></strong> since they give the rules for the dynamics.</p>
<p>Remember that <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> are state variables, so they are all <em>functions of time</em>. At any instant in time, the values <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, <span class="math inline">\(z\)</span> have a specific value. Thus, at any instant in time, evaluating the functions <span class="math inline">\(f(x, y, z)\)</span>, <span class="math inline">\(g(x, y, z)\)</span>, and <span class="math inline">\(h(x, y, z)\)</span> at the current state produces a specific, scalar value. If we wanted to make this perfectly explicit, we could write <span class="math inline">\(g_x(x(t), y(t), z(t))\)</span>, which makes it clear that the output of <span class="math inline">\(g_x()\)</span> is a function of time.</p>
<div class="takenote">
<p>Mathematically, a <strong><em>dynamical system</em></strong> consists of two things:</p>
<ol type="i">
<li>The state variables, which is a set of quantities that vary in time.</li>
<li>The dynamics, which is the set of dynamical functions, one function for each of the state variables.</li>
</ol>
</div>
<p>A simple example is the dynamics of retirement-account interest. In a retirement account, you put aside money—this is called “contributing”—each month. The value <span class="math inline">\(V(t)\)</span> of the account accumulates over time, both due to new monthly deposits and to the interest <span class="math inline">\(r\)</span> earned on the current account value. If you are setting aside <span class="math inline">\(M\)</span> dollars per month, the dynamics are: <span class="math display">\[\partial_t V = r V + M\ .\]</span> The left-hand side of this equation is boilerplate for “the way the <span class="math inline">\(V\)</span> component of state changes is described by the dynamical function <span class="math inline">\(rV + M\)</span>.” This is a function of <span class="math inline">\(V\)</span> with parameters <span class="math inline">\(r\)</span> and <span class="math inline">\(M\)</span>. In this example, there is just the one state variable <span class="math inline">\(V\)</span>, so the dynamical function has only one argument: <span class="math inline">\(V\)</span>.</p>
<p>Remember that the dynamical function is something that the modeler constructs from her knowledge of the system. To model the dynamics of a pendulum requires some knowledge of physics. Without getting involved with the physics, we note that the oscillatory nature of pendulum movement means that there must be at least two state variables. A physicist learns that a good way to describe the motion uses these two quantities: the angle <span class="math inline">\(\theta(t)\)</span> of the pendulum rod with respect to the vertical and the angular velocity <span class="math inline">\(v(t)\)</span> telling how the velocity changes with time. Since there are two state variables, there must be two dynamical functions. For a pendulum, one of the functions, the one for <span class="math inline">\(\partial_t v\)</span> comes from applying Newton’s Second Law: <span class="math inline">\(F = m a\)</span>. (Remember that <span class="math inline">\(\partial_t v\)</span> is an acceleration.) So one of the differential equations is <span class="math display">\[\partial_t v  =  f(\theta, v) \equiv - \sin(\theta)\]</span></p>
<p>The other equation comes from the definition that the derivative of the position <span class="math inline">\(\theta\)</span> is the velocity. <span class="math display">\[\partial_t \theta  =  g(\theta, v) \equiv  v\\
\]</span></p>
<div class="callout callout-style-default callout-note no-icon callout-titled" data-latex="">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why define a state variable <span class="math inline">\(v\)</span> when it is, by definition, the same as <span class="math inline">\(\partial_t \theta(t)\)</span>?</p>
<p>Even though the dynamical equation <span class="math inline">\(\partial_t \theta(t) = v\)</span> is a calculus tautology, we need always to be explicit about what are the two quantities in the dynamical state. The <span class="math inline">\(\partial_t \theta\)</span> differential equation comes for free from basic calculus concepts. The second equation is about the physics, that is, the relationship between forces and acceleration.</p>
<p>There is a style of writing dynamics equations that discards such tautologies. For example, the pendulum dynamics are often written <span class="math display">\[\partial_{tt} \theta(t) = - \sin(\theta)\ .\]</span> This sort of equation, containing a second-order derivative, is called a <strong><em>second-order differential equation</em></strong>. In contrast, the two equations, one for <span class="math inline">\(\partial_t \theta\)</span> and one for <span class="math inline">\(\partial_t v\)</span> are called <strong><em>first-order differential equations</em></strong> because each involves a first-order derivative. We will return to this second-order style in <a href="#sec-second-order-de" class="quarto-xref"><span class="quarto-unresolved-ref">sec-second-order-de</span></a> since it is often encountered in physics and engineering. For now, we are avoiding the second-order style because it obscures the fact that there are two state variables: <span class="math inline">\(\theta(t)\)</span> and <span class="math inline">\(v(t)\)</span>.</p>
</div>
</div>
<div class="example">
<p><span class="math inline">\(\ \)</span></p>
<p>Consider the population of two interacting species, say rabbits and foxes. As you know, the relationship between rabbits and foxes is rather unhappy from the rabbits’ point of view even if it is fulfilling for the foxes.</p>
<p>Many people assume that such populations are more or less fixed: that the rabbits are in a steady balance with the foxes. In fact, as any gardener can tell you, some years there are lots of rabbits and others not: an oscillation. Just from this fact, we know that the dynamical state must have at least two components.</p>
<p>In a simple, but informative, model, the two components of the dynamical state are <span class="math inline">\(r(t)\)</span> and <span class="math inline">\(f(t)\)</span>, the population of rabbits and foxes respectively. In the absence of foxes, the dynamics of rabbits are exponential growth; each successive generation is larger than the previous one. This can be described by a dynamical equation <span class="math inline">\(\partial_t r(t) = \alpha r(t)\)</span>, where <span class="math inline">\(\alpha\)</span> is a fixed quantity that describes rabbit fecundity.</p>
<p>Similarly, in the absence of food (rabbits are fox food), the foxes will starve or emigrate, so the dynamical equation for foxes is very similar <span class="math inline">\(\partial_t f(t) = - \gamma f(t)\)</span>, where <span class="math inline">\(\gamma\)</span> is a fixed quantity that indicates the rate at which foxes die or emigrate.</p>
<p>Of course, in real ecosystems there are many other quantities that change and that are relevant. For instance, foxes eat not only rabbits, but birds and frogs and earthworms and berries. And the diet of rabbits eat weeds and grass (which is generally in plentiful supply), but also the gardener’s flowers and carrots (and other vegetables). Growth in the rabbit population leads to decrease in available flowers and vegetables, which in turn leads to slower growth (or even population decline) for rabbits.</p>
<p>In the spirit of illustrating dynamics, we will leave out these important complexities and imagine that the state consists of just two numbers: how many rabbits there are and how many foxes. The dynamics therefore involve two equations, one for <span class="math inline">\(\partial_t r\)</span> and one for <span class="math inline">\(\partial_t f\)</span>. For the rabbit/fox model, we will allow the rabbit population change (<span class="math inline">\(\partial_t r\)</span>) to be affected by fox prediation and similarly let the fox population change (<span class="math inline">\(\partial_t f\)</span>) reflect the consumption of rabbits as food, writing: <span class="math display">\[\partial_t r = \ \ \ \ \ \alpha\, r - \overbrace{\beta\, f r}^{\text{fox predation}}\\
\partial_t f = \underbrace{\delta\, r f}_{\text{rabbits as food}} - \gamma\, f\]</span></p>
<p>The quantities <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span>, and <span class="math inline">\(\delta\)</span> are parameters quantify the biology of the system: the reproduction rate of rabbits, the need of foxes for food (rabbits) to reproduce, the hunting success of foxes, and the death or emigration of foxes in response to a shortage of food.</p>
<p>How are you supposed to know that <span class="math inline">\(r\)</span> and <span class="math inline">\(f\)</span> are state variables while quantities like <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> are parameters? Because there is a differential equation involving <span class="math inline">\(\partial_t r\)</span> and <span class="math inline">\(\partial_t f\)</span>, while no differential equation has been given describing <span class="math inline">\(\partial_t \beta\)</span> or <span class="math inline">\(\partial_t \alpha\)</span>.</p>
<p>Coming up with this description of dynamics requires knowing something about rabbits and foxes. The particular forms used, for instance the <strong><em>interaction term</em></strong> <span class="math inline">\(r f\)</span>, come from modeling experience. The interaction term is well named because it is about the literal, biological interaction of foxes and rabbits.</p>
</div>
</section>
<section id="state-space-and-flow-field" class="level2 page-columns page-full" data-number="40.5">
<h2 data-number="40.5" class="anchored" data-anchor-id="state-space-and-flow-field"><span class="header-section-number">40.5</span> State space and flow field</h2>
<p>For the purpose of developing intuition it is helpful to represent the instantaneous state as a point in a graphical frame and the dynamics as a field of vectors showing how, for each possible state, the state changes. For instance, in the Rabbit-Fox dynamics, the state is the pair <span class="math inline">\((r, f)\)</span> and the <strong><em>state space</em></strong> is the coordinate plane spanned by <span class="math inline">\(r\)</span> and <span class="math inline">\(f\)</span>.</p>
<p>The present state of the system might be any point in the state space. But once we know the present state, the dynamical functions <em>evaluated at the present state</em> tell us how the state changes over a small increment in time. The step over a small increment of time can be represented by a vector.</p>
<p>Let’s illustrate with the Rabbit-Fox system, whose dynamical equations are given above. The dynamical functions take a position in state space as input. Each of the functions returns a scalar.</p>
<p>To make a plot, we need numerical values for all the parameters in those equations.</p>
<p>The vector field corresponding to the dynamics is called a <strong><em>flow</em></strong>, as if it were a pool of swirling water. <a href="#fig-rabbit-fox-vectors" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-rabbit-fox-vectors</span></a> shows the flow of the rabbit/fox system.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-rabbit-fox-vectors" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center" data-cap-location="margin">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-rabbit-fox-vectors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="B6-diff-eq_files/figure-html/fig-rabbit-fox-vectors-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-rabbit-fox-vectors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;40.2: The dynamics of the rabbit/fox system shown as a vector field over the state space. The parameters have been set, for the purpose of illustration, to <span class="math inline">\(\alpha = 2/3\)</span>, <span class="math inline">\(\beta = 4/3\)</span>, <span class="math inline">\(\gamma = 1\)</span>, and <span class="math inline">\(\delta = 1\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Staying with the analogy to a pool of swirling water or the currents in a river, you can place a lightweight marker such as a leaf at some point in the flow and follow its path over time. This path—position in state space as a function of time—is called the <strong><em>trajectory</em></strong> of the flow. There are many possible trajectories, depending on where you place the leaf.</p>
<p>In Chapter 33 we considered the path followed by a robot arm. In that chapter, we separated out the <span class="math inline">\(x\)</span>- and <span class="math inline">\(y\)</span>-components of the arm’s position over time, calling them functions <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span>. Analogously, the the decomposition of a trajectory from an initial condition in the flow—this would be <span class="math inline">\(r(t)\)</span> and <span class="math inline">\(f(t)\)</span> for the rabbit/fox system—gives us the <strong><em>solution</em></strong> to the differential equation.</p>
<p>Each component of the solution is called a <strong><em>time series</em></strong> and is often plotted as a function of time, for instance <span class="math inline">\(r(t)\)</span> versus <span class="math inline">\(t\)</span>.</p>
<p>From the flow field, you can approximate the trajectory that will be followed from any initial condition. Starting from the <strong><em>initial condition</em></strong>, just follow the flow. You already have some practice following a flow from your study of the <strong><em>gradient ascent</em></strong> method of optimization described in Chapter 23. At the argmax, the gradient is nil. Thus, the gradient ascent method stops at the argmax. We will see an analogous behavior in dynamical systems: any place where the flow is nil is a potential resting point for the state, called a <strong><em>fixed point</em></strong>.</p>
<div class="example">
<p><span class="math inline">\(\ \)</span></p>
<p>Let’s return to the pendulum and examine its flow field. We will modify the equations just a little bit to include air resistance in the model. Air resistance is a force, so we know it will appear in the <span class="math inline">\(\partial_t v_\theta(t)\)</span> equation. A common model for air resistance has it proportional in size to the square of the velocity and with a direction that is the opposite of the velocity. In a differential equation, the model of air resistance can be written as <span class="math inline">\(- \alpha\, L\, \text{sign}(v(t))\ v(t)^2\)</span>, where <span class="math inline">\(\text{sign}()\)</span> is a piecewise function that has the value <span class="math inline">\(+1\)</span> when the argument is positive and <span class="math inline">\(-1\)</span> when the argument is negative. <span class="math inline">\(L\)</span> is the length of the pendulum. <span class="math display">\[\partial_t \theta = v\\
\partial_t v = - \sin(\theta) - \alpha\,L^2\, \text{sign}(v)\ v^2\]</span> (Keep in mind as always that for dynamical systems a state variable like <span class="math inline">\(\theta\)</span> is also a function of time <span class="math inline">\(\theta(t)\)</span>.) Whenever you have a state variable, you know that it is a function of time and so the explicit <span class="math inline">\((t)\)</span> is often omitted for the sake of conciseness.</p>
<p><a href="#fig-pendulum-in-air" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-pendulum-in-air</span></a> shows the flow field of the pendulum. Also shown is a trajectory and the two time series corresponding to that trajectory.</p>
<div class="cell" data-layout-align="center">
<pre><code>## Solution containing functions theta(t), v(t).</code></pre>
<div class="cell-output-display">
<div id="fig-pendulum-in-air-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pendulum-in-air-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="B6-diff-eq_files/figure-html/fig-pendulum-in-air-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pendulum-in-air-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;40.3: The flow field of a pendulum with air resistance. From the initial condition (marked by <span class="math inline">\(\color{red}{\text{x}}\)</span>), a trajectory is sketched out for <span class="math inline">\(0 \leq t \leq 20\)</span>. The individual components of that trajectory are graphed as time series.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-pendulum-in-air-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pendulum-in-air-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="B6-diff-eq_files/figure-html/fig-pendulum-in-air-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pendulum-in-air-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;40.4: The flow field of a pendulum with air resistance. From the initial condition (marked by <span class="math inline">\(\color{red}{\text{x}}\)</span>), a trajectory is sketched out for <span class="math inline">\(0 \leq t \leq 20\)</span>. The individual components of that trajectory are graphed as time series.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The pendulum was started out by lifting it to an angle of <span class="math inline">\(45^\circ\)</span> and giving it an initial upward velocity. The bob swings up for a bit before being reversed by gravity and swinging toward <span class="math inline">\(\theta = 0\)</span> and beyond. Due to air resistance, the amplitude of swinging decreases over time.</p>
</div>
<p>The flow of a dynamical system tells how different points in state space are connected. Because movement of the state is continuous in time and the state space itself is continuous, the connections cannot be stated in the form “this point goes to that point.” Instead, as has been the case all along in calculus, we describe the movement in terms of a “velocity” vector. Each dynamical function specifies one component of the “velocity” vector, taken together they tell the <strong><em>direction</em></strong> and <strong><em>speed</em></strong> of movement of the state at each instant in time.</p>
<p>Perhaps it would be better to use the term <strong><em>state velocity</em></strong> instead of “velocity.” In physics and most aspects of everyday life, “velocity” refers to the rate of change of physical <strong><em>position</em></strong> of an object. Similarly, the state velocity tells the rate of change of the position of the state. It is a useful visualization technique to think of the state as an object skating around the state space in a manner directed by the dynamical functions. But the state space almost always includes components other than physical position. For instance, in the rabbit/fox model, the state says nothing about where individual rabbits and foxes are located in their environment; it is all about the <strong><em>density</em></strong> of animals in a region.</p>
<p>In physics, often the state space consists of position in physical state as well as the physical velocity in physical space. For instance, the state might consist of the three <span class="math inline">\(x, y, z\)</span> components of physical position as well as the three <span class="math inline">\(v_x, v_y, v_z\)</span> components of physical velocity. Altogether, that is a six-dimensional state space. The <strong><em>state velocity</em></strong> also has six components. Three of those components will be the “velocity of the velocity,” that is, the direction and speed with which the physical velocity is changing.</p>
<div class="example page-columns page-full">
<p><span class="math inline">\(\ \)</span></p>
<p>Returning to the Chutes and Ladders game used as an example near the start of this chapter …</p>
<p>The state in chutes and ladders is one of the hundred numbers 1, 2, <span class="math inline">\(\ldots\)</span>, 100. This is a discrete state space. Therefore, we can describe the “flow” in a very concrete way: how each state is directly connected to another. <a href="#fig-chutes-flow" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-chutes-flow</span></a> shows these connections. There is no velocity involved because there is no infinitesimal movement of state. For instance, state 47 connects directly to state 26.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-chutes-flow" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center" data-cap-location="margin">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-chutes-flow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="www/chutes-and-ladders-flow.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-chutes-flow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;40.5: The “flow” connecting the discrete states in the dice-free Chutes and Ladders game. Source: Maj. Austin Davis
</figcaption>
</figure>
</div>
</div>
</div>
<p>In the no-dice game, the state follows the arrows. Looking carefully at <a href="#fig-chutes-flow" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-chutes-flow</span></a>, you can see that each state has a forward connection to at most one state. This is the hallmark of determinism.</p>
<p>In the children’s game, the play is not deterministic because a die is used to indicate which state follows from each other state. A die has six faces with the six numbers 1 to 6. So, each state is connected to <em>six</em> other states in the forward direction. Which of the six is to be followed depends on the number that comes up on the die. Multiple forward connections means the dynamics are <strong><em>stochastic</em></strong> (random).</p>
<p>Straightforward examination of the flow often tells you a lot about the big picture of the system. In dice-free Chutes and Ladders, The 100 states are divided into three isolated islands. State 1 is part of the island in the lower right corner of <a href="#fig-chutes-flow" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-chutes-flow</span></a>. Follow the arrows starting from any place on that island and you will eventually reach state 84. And state 84 is part of a cycle <span class="math inline">\(84 \rightarrow 85 \rightarrow \cdots \rightarrow 28 \rightarrow 84 \rightarrow \cdots\)</span>. Once you are on that cycle, you never get off. We will see such cycles in continuous-time dynamical systems as well.</p>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled page-columns page-full" data-latex="">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math in the World: Numerical weather forecasting
</div>
</div>
<div class="callout-body-container callout-body page-columns page-full">
<p><em><a href="https://archive.org/details/weatherpredictio00richrich/page/184/mode/2up?view=theater">Weather forecasting by numerical process</a></em> is a highly influential book, from 1922, by <a href="https://en.wikipedia.org/wiki/Lewis_Fry_Richardson">Lewis Fry Richardson</a>. He envisioned a calculation for a weather forecast as a kind of function. The domain for the forecast is the latitude and longitude of a point on the globe, rather than the rectilinear organization of corridor.</p>
<p>One fantastic illustration of the idea shows a building constructed in the form of an inside-out globe. <a href="https://www.cabinetmagazine.org/issues/27/foer.php">Source</a> At each of many points on the globe, there is a business. (You can see this most easily in the foreground, which shows several boxes of workers.)</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-richardson-globe" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center" data-cap-location="margin">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-richardson-globe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="www/Richardson-globe.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-richardson-globe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;40.6: An artist’s depiction of the organization of calculations for weather forecasting by Richardson’s system.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In each business there is a person who will report the current air pressure at that point on the globe, another person who reports the temperature, another reporting humidity, and so on. To compute the predicted weather for the next day, the business has a staff assigned to visit the neighboring businesses to find out the pressure, temperature, humidity, etc. Still other staffers take the collected output from the neighbors and carry out the arithmetic to translate those outputs into the forecast for tomorrow. For instance, knowing the pressure at neighboring points enables the direction of wind to be calculated, thus the humidity and temperature of air coming in to and out of the region the business handles. In today’s numerical weather prediction models, the globe is divided very finely by latitude, longitude, and altitude, and software handles both the storage of present conditions and the calculation from that of the future a few minutes later. Repeating the process using the forecast enables a prediction to be made for a few minutes after that, and so on.</p>
<p>Some of the most important concepts in calculus relate to the process of collecting outputs from neighboring points and combining them: for instance finding the difference or the sum. To illustrate, here is the first set of equations from Richardson’s <em>Weather forecasting …</em> written in the notation of calculus:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="www/Richardson-equations.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>You can hardly be expected at this point to understand the calculations described by these equations, which involve the physics of air flow, the coriolis force, etc. but it is worth pointing out some of the notation:</p>
<ul>
<li>The equations are about the momentum of a column of air at a particular latitude (<span class="math inline">\(\phi\)</span>) and longitude.</li>
<li><span class="math inline">\(M_E\)</span> and <span class="math inline">\(M_N\)</span> are east-west and north-south components of that momentum.</li>
<li><span class="math inline">\(\partial M_E /\partial t\)</span> is the rate at which the east-west momentum will change in the next small interval of time (<span class="math inline">\(\partial t\)</span>).</li>
<li><span class="math inline">\(p_G\)</span> is the air pressure at ground level from that column of air.</li>
<li><span class="math inline">\(\partial p_G / \partial n\)</span> is about the difference between air pressure in the column of air and the columns to the north and south.</li>
</ul>
<p>Calculus provides both the notation for describing the physics of climate and the means to translate this physics into arithmetic calculation.</p>
</div>
</div>
<!--

1. D-93XWJ: Given a flow field in one or two dimensions, draw a plausible trajectory
2. G-MC8XJ: Explain why determinism rules out two different trajectories passing through any single point in state space. 
3. X-KZLDP: Distinguish between the **instantaneous state** and the **state space**.
4. M-P1ZSV: Distinguish between graphics of time series and trajectories by examination or construction of the graph's axes.
5. N-O88YI: From a trajectory drawn on a graph of a flow field, construct a plausible time-series plot
6. X-MO2V8: Understand these terms and describe the relationships among them in the context of dynamics: instantaneous state, state space, state variable, dynamical function, flow field, trajectory, time-series, differential equation, initial condition, solution

-->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dtkaplan\.github\.io\/MC2\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../dynamics-part.html" class="pagination-link" aria-label="BLOCK V. Dynamics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">BLOCK V. Dynamics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Dynamics/B6-solution.html" class="pagination-link" aria-label="Finding a &quot;solution&quot;">
        <span class="nav-page-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Finding a “solution”</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dtkaplan/MC2/edit/main/Dynamics/B6-diff-eq.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>