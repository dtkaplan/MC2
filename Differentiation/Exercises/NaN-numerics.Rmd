---
id: "NaN-numerics"
origin: "141 DD30"
author: "Daniel Kaplan"
---

It is simple enough to say to an  elementary-school  pupil that "division by zero is an  error." But what is a computer to  do when, for whatever  reason, it divides  by an  amount that is zero generated by a not-erroneous early computation? In  many computer languages (including  R) the programmer can arrange  that  a unacceptable situation  causes an error message to  be "thrown." This generally causes the program to stop. See this account of the [USS  Yorktown](https://en.wikipedia.org/wiki/USS_Yorktown_(CG-48))  (under "Smart  ship testbed") for an  example of why stopping the program is not always an acceptable practice.

Modern computer arithmetic systems, implemented in hardware, take a  different  approach to division by zero. Rather than an error, divide-by-zero calculations return a  definite value called "not a number"  and printed as `NaN`. Rather than stopping the  program,  calculations  can  continue on. Any  calculation  involving  `NaN`, such  as  `3 +  NaN` or `NaN/NaN` produces a  `NaN`. This  clever design allows  the system-level programmer to determine where and whether a  division by zero needs to be dealt with.

```{r daily-digital-30-QA4, echo=FALSE}
askMC(
  prompt = "Warm up: Using the sandbox, determine which one of these  arithmetic expressions **does not** produce `NaN` as the output.",
  choices = c("`1/0`", "`0/0`", "`0*NaN`",  '`NaN/NaN`',
              "`5e20 + NaN*1e-50`", "`NaN - NaN`",
              "`NaN * Inf`",  "`sin(NaN)`", "`sqrt(NaN)`", "`Inf/Inf`", "+`1/Inf`+")
)
```

The  `NaN` strategy is effective in plotting. Programs such as `slice_plot()` simply ignore points whose value  is `NaN`.  As a result, the shape  of the  graph is determined by those  points nearby, not at, the singularity. The overall effect is that the graph indicates whether the singularity is removable without the user having to do any juggling with `NaN`.

For each of the following functions of $x$, use the following procedure:

1. Plug in  the indicated value of  $x = x^\star$  to find  out if  the computer returns `NaN`. If so,  the  function  has  a singularity at $x^\star$.
2. Draw  a graph of  the  function for a region very close to  $x^\star$ and see if  the  function behaves smoothly very  close to  $x^\star$. If so, find   the  function's limit  $x \rightarrow x^\star$. (Pay  attention to the vertical axis scale.)
3. Look  at the formula for the  function to see if there  are equal terms in the  numerator and the  denominator that you can cancel out to  create  a  new  function that  is  the  same, everywhere  but $x^\star$, as the original.

Example: $f(x) \equiv \frac{x^2 +  2x}{x^3 + 4x}$ at  $x^\star = 0$. The sandbox code has been set up   for steps (1) and (2).  You will have  to  do  step (3) by  hand, using   algebra. Notice that `f(xstar)` returns `NaN`,  indicating that there is a singularity at `xstar`. The  graph, however, is  perfectly  smooth and has a value of 0.5 at  `xstar`. So the limit $\lim_{x\rightarrow 0} f(x) = 0.5$. Using algebra,  we  can  rewrite $f(x)$

$$f(x) = \frac{x^2 +  2x}{x^3 + 4x} = \frac{x}{x} \frac{x + 2}{x^2 + 4}.$$ Eliminating the $\frac{x}{x}$,  the remainder of  the expression evaluates to  1/2 at $x=0$ without  any  problematic  division by  zero. This  agrees perfectly with the graph.

::: {.scaffolding  data-latex=""}
```{r results="hide"}
f <- function(x) {(x^2 + 2*x) / (x^3 + 4*x)}
xstar <- 0
f(xstar)

slice_plot(f(x) ~  x, bounds(x =  xstar + 0.001*c(-1,  1)))
```
:::

```{r daily-digital-30-TF1, echo=FALSE}
askMC(
  prompt = "1) True or false: $$f(x)\\equiv \\frac{x^2 + 2x}{x^3 - 4x}$$ behaves nicely near $x^{\\star} = 0$.",
  "+TRUE+", 
  "FALSE",
  random_answer_order = FALSE)
```

```{r daily-digital-30-TF2, echo=FALSE}
askMC(
  prompt = "2) True or false: $$f(x)\\equiv \\frac{x^2 + 2x}{x^3 - 4x}$$ behaves nicely near $x^{\\star} = -2$.",
  "+TRUE+", 
  "FALSE",
  random_answer_order = FALSE)
```

```{r daily-digital-30-TF3, echo=FALSE}
askMC(
  prompt = "3) True or false: $$f(x)\\equiv \\frac{x^2 + 2x}{x^3 - 4x}$$ behaves nicely near $x^{\\star} = 2$.",
  "TRUE", 
  "+FALSE+",
  random_answer_order = FALSE)
```

```{r daily-digital-30-TF4, echo=FALSE}
askMC(
  prompt = "4) True or false: $$f(x)\\equiv \\frac{x^2 + x}{x + \\sqrt{x + 3}}$$ behaves nicely near $x^{\\star} = -2$.",
  "+TRUE+", 
  "FALSE",
  random_answer_order = FALSE)
```

```{r daily-digital-30-TF5, echo=FALSE}
askMC(
  prompt = "5) True or false: $$f(x)\\equiv x \\ln(x)$$ behaves nicely when approaching $x^{\\star} = 0$ from above.",
  "+TRUE+", 
  "FALSE",
  random_answer_order = FALSE)
```


